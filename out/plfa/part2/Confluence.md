---
src       : "src/plfa/part2/Confluence.lagda.md"
title     : "Confluence: Confluence of untyped lambda calculus ğŸš§"
layout    : page
prev      : /Untyped/
permalink : /Confluence/
next      : /BigStep/
---

{% raw %}<pre class="Agda"><a id="166" class="Keyword">module</a> <a id="173" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}" class="Module">plfa.part2.Confluence</a> <a id="195" class="Keyword">where</a>
</pre>{% endraw %}
## Introduction

In this chapter we prove that beta reduction is _confluent_, a
property also known as _Church-Rosser_. That is, if there are
reduction sequences from any term `L` to two different terms `Mâ‚` and
`Mâ‚‚`, then there exist reduction sequences from those two terms to
some common term `N`. In pictures:

        L
       / \
      /   \
     /     \
    Mâ‚      Mâ‚‚
     \     /
      \   /
       \ /
        N

where downward lines are instances of `â€”â† `.

Confluence is studied in many other kinds of rewrite systems besides
the lambda calculus, and it is well known how to prove confluence in
rewrite systems that enjoy the _diamond property_, a single-step
version of confluence. Let `â‡›` be a relation.  Then `â‡›` has the
diamond property if whenever `L â‡› Mâ‚` and `L â‡› Mâ‚‚`, then there exists
an `N` such that `Mâ‚ â‡› N` and `Mâ‚‚ â‡› N`. This is just an instance of
the same picture above, where downward lines are now instance of `â‡›`.
If we write `â‡›*` for the reflexive and transitive closure of `â‡›`, then
confluence of `â‡›*` follows immediately from the diamond property.

Unfortunately, reduction in the lambda calculus does not satisfy the
diamond property. Here is a counter example.

    (Î» x. x x)((Î» x. x) a) â€”â†’ (Î» x. x x) a
    (Î» x. x x)((Î» x. x) a) â€”â†’ ((Î» x. x) a) ((Î» x. x) a)

Both terms can reduce to `a a`, but the second term requires two steps
to get there, not one.

To side-step this problem, we'll define an auxilliary reduction
relation, called _parallel reduction_, that can perform many
reductions simultaneously and thereby satisfy the diamond property.
Furthermore, we show that a parallel reduction sequence exists between
any two terms if and only if a beta reduction sequence exists between them.
Thus, we can reduce the proof of confluence for beta reduction to
confluence for parallel reduction.


## Imports

{% raw %}<pre class="Agda"><a id="2056" class="Keyword">open</a> <a id="2061" class="Keyword">import</a> <a id="2068" href="https://agda.github.io/agda-stdlib/v1.3/Relation.Binary.PropositionalEquality.html" class="Module">Relation.Binary.PropositionalEquality</a> <a id="2106" class="Keyword">using</a> <a id="2112" class="Symbol">(</a><a id="2113" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">_â‰¡_</a><a id="2116" class="Symbol">;</a> <a id="2118" href="Agda.Builtin.Equality.html#208" class="InductiveConstructor">refl</a><a id="2122" class="Symbol">)</a>
<a id="2124" class="Keyword">open</a> <a id="2129" class="Keyword">import</a> <a id="2136" href="https://agda.github.io/agda-stdlib/v1.3/Function.html" class="Module">Function</a> <a id="2145" class="Keyword">using</a> <a id="2151" class="Symbol">(</a><a id="2152" href="https://agda.github.io/agda-stdlib/v1.3/Function.Base.html#992" class="Function Operator">_âˆ˜_</a><a id="2155" class="Symbol">)</a>
<a id="2157" class="Keyword">open</a> <a id="2162" class="Keyword">import</a> <a id="2169" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html" class="Module">Data.Product</a> <a id="2182" class="Keyword">using</a> <a id="2188" class="Symbol">(</a><a id="2189" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">_Ã—_</a><a id="2192" class="Symbol">;</a> <a id="2194" href="Agda.Builtin.Sigma.html#166" class="Record">Î£</a><a id="2195" class="Symbol">;</a> <a id="2197" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Î£-syntax</a><a id="2205" class="Symbol">;</a> <a id="2207" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1369" class="Function">âˆƒ</a><a id="2208" class="Symbol">;</a> <a id="2210" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1788" class="Function">âˆƒ-syntax</a><a id="2218" class="Symbol">;</a> <a id="2220" href="Agda.Builtin.Sigma.html#252" class="Field">projâ‚</a><a id="2225" class="Symbol">;</a> <a id="2227" href="Agda.Builtin.Sigma.html#264" class="Field">projâ‚‚</a><a id="2232" class="Symbol">)</a>
  <a id="2236" class="Keyword">renaming</a> <a id="2245" class="Symbol">(</a><a id="2246" href="Agda.Builtin.Sigma.html#236" class="InductiveConstructor Operator">_,_</a> <a id="2250" class="Symbol">to</a> <a id="_,_"></a><a id="2253" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨_,_âŸ©</a><a id="2258" class="Symbol">)</a>
<a id="2260" class="Keyword">open</a> <a id="2265" class="Keyword">import</a> <a id="2272" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}" class="Module">plfa.part2.Substitution</a> <a id="2296" class="Keyword">using</a> <a id="2302" class="Symbol">(</a><a id="2303" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2192" class="Function">Rename</a><a id="2309" class="Symbol">;</a> <a id="2311" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a><a id="2316" class="Symbol">)</a>
<a id="2318" class="Keyword">open</a> <a id="2323" class="Keyword">import</a> <a id="2330" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}" class="Module">plfa.part2.Untyped</a>
  <a id="2351" class="Keyword">using</a> <a id="2357" class="Symbol">(</a><a id="2358" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9948" class="Datatype Operator">_â€”â†’_</a><a id="2362" class="Symbol">;</a> <a id="2364" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10178" class="InductiveConstructor">Î²</a><a id="2365" class="Symbol">;</a> <a id="2367" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9998" class="InductiveConstructor">Î¾â‚</a><a id="2369" class="Symbol">;</a> <a id="2371" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10088" class="InductiveConstructor">Î¾â‚‚</a><a id="2373" class="Symbol">;</a> <a id="2375" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10286" class="InductiveConstructor">Î¶</a><a id="2376" class="Symbol">;</a> <a id="2378" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11068" class="Datatype Operator">_â€”â† _</a><a id="2382" class="Symbol">;</a> <a id="2384" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11274" class="Function Operator">begin_</a><a id="2390" class="Symbol">;</a> <a id="2392" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11174" class="InductiveConstructor Operator">_â€”â†’âŸ¨_âŸ©_</a><a id="2399" class="Symbol">;</a> <a id="2401" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22017" class="Function Operator">_â€”â† âŸ¨_âŸ©_</a><a id="2408" class="Symbol">;</a> <a id="2410" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11118" class="InductiveConstructor Operator">_âˆ</a><a id="2412" class="Symbol">;</a>
  <a id="2416" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#23928" class="Function">abs-cong</a><a id="2424" class="Symbol">;</a> <a id="2426" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22931" class="Function">appL-cong</a><a id="2435" class="Symbol">;</a> <a id="2437" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#23700" class="Function">appR-cong</a><a id="2446" class="Symbol">;</a> <a id="2448" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#21747" class="Function">â€”â† -trans</a><a id="2456" class="Symbol">;</a>
  <a id="2460" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">_âŠ¢_</a><a id="2463" class="Symbol">;</a> <a id="2465" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">_âˆ‹_</a><a id="2468" class="Symbol">;</a> <a id="2470" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`_</a><a id="2472" class="Symbol">;</a> <a id="2474" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#5111" class="Function Operator">#_</a><a id="2476" class="Symbol">;</a> <a id="2478" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">_,_</a><a id="2481" class="Symbol">;</a> <a id="2483" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="2484" class="Symbol">;</a> <a id="2486" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›_</a><a id="2488" class="Symbol">;</a> <a id="2490" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">_Â·_</a><a id="2493" class="Symbol">;</a> <a id="2495" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">_[_]</a><a id="2499" class="Symbol">;</a>
  <a id="2503" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6235" class="Function">rename</a><a id="2509" class="Symbol">;</a> <a id="2511" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#5925" class="Function">ext</a><a id="2514" class="Symbol">;</a> <a id="2516" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a><a id="2520" class="Symbol">;</a> <a id="2522" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a><a id="2523" class="Symbol">;</a> <a id="2525" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S_</a><a id="2527" class="Symbol">;</a> <a id="2529" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6963" class="Function">subst</a><a id="2534" class="Symbol">;</a> <a id="2536" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7375" class="Function">subst-zero</a><a id="2546" class="Symbol">)</a>
</pre>{% endraw %}
## Parallel Reduction

The parallel reduction relation is defined as follows.

{% raw %}<pre class="Agda"><a id="2636" class="Keyword">infix</a> <a id="2642" class="Number">2</a> <a id="2644" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">_â‡›_</a>

<a id="2649" class="Keyword">data</a> <a id="_â‡›_"></a><a id="2654" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">_â‡›_</a> <a id="2658" class="Symbol">:</a> <a id="2660" class="Symbol">âˆ€</a> <a id="2662" class="Symbol">{</a><a id="2663" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2663" class="Bound">Î“</a> <a id="2665" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2665" class="Bound">A</a><a id="2666" class="Symbol">}</a> <a id="2668" class="Symbol">â†’</a> <a id="2670" class="Symbol">(</a><a id="2671" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2663" class="Bound">Î“</a> <a id="2673" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="2675" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2665" class="Bound">A</a><a id="2676" class="Symbol">)</a> <a id="2678" class="Symbol">â†’</a> <a id="2680" class="Symbol">(</a><a id="2681" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2663" class="Bound">Î“</a> <a id="2683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="2685" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2665" class="Bound">A</a><a id="2686" class="Symbol">)</a> <a id="2688" class="Symbol">â†’</a> <a id="2690" class="PrimitiveType">Set</a> <a id="2694" class="Keyword">where</a>

  <a id="_â‡›_.pvar"></a><a id="2703" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a> <a id="2708" class="Symbol">:</a> <a id="2710" class="Symbol">âˆ€{</a><a id="2712" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2712" class="Bound">Î“</a> <a id="2714" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2714" class="Bound">A</a><a id="2715" class="Symbol">}{</a><a id="2717" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2717" class="Bound">x</a> <a id="2719" class="Symbol">:</a> <a id="2721" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2712" class="Bound">Î“</a> <a id="2723" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">âˆ‹</a> <a id="2725" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2714" class="Bound">A</a><a id="2726" class="Symbol">}</a>
      <a id="2734" class="Comment">---------</a>
    <a id="2748" class="Symbol">â†’</a> <a id="2750" class="Symbol">(</a><a id="2751" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="2753" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2717" class="Bound">x</a><a id="2754" class="Symbol">)</a> <a id="2756" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="2758" class="Symbol">(</a><a id="2759" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="2761" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2717" class="Bound">x</a><a id="2762" class="Symbol">)</a>

  <a id="_â‡›_.pabs"></a><a id="2767" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="2772" class="Symbol">:</a> <a id="2774" class="Symbol">âˆ€{</a><a id="2776" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2776" class="Bound">Î“</a><a id="2777" class="Symbol">}{</a><a id="2779" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2779" class="Bound">N</a> <a id="2781" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2781" class="Bound">Nâ€²</a> <a id="2784" class="Symbol">:</a> <a id="2786" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2776" class="Bound">Î“</a> <a id="2788" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">,</a> <a id="2790" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a> <a id="2792" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="2794" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="2795" class="Symbol">}</a>
    <a id="2801" class="Symbol">â†’</a> <a id="2803" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2779" class="Bound">N</a> <a id="2805" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="2807" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2781" class="Bound">Nâ€²</a>
      <a id="2816" class="Comment">----------</a>
    <a id="2831" class="Symbol">â†’</a> <a id="2833" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="2835" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2779" class="Bound">N</a> <a id="2837" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="2839" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="2841" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2781" class="Bound">Nâ€²</a>

  <a id="_â‡›_.papp"></a><a id="2847" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="2852" class="Symbol">:</a> <a id="2854" class="Symbol">âˆ€{</a><a id="2856" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2856" class="Bound">Î“</a><a id="2857" class="Symbol">}{</a><a id="2859" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2859" class="Bound">L</a> <a id="2861" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2861" class="Bound">Lâ€²</a> <a id="2864" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2864" class="Bound">M</a> <a id="2866" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2866" class="Bound">Mâ€²</a> <a id="2869" class="Symbol">:</a> <a id="2871" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2856" class="Bound">Î“</a> <a id="2873" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="2875" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="2876" class="Symbol">}</a>
    <a id="2882" class="Symbol">â†’</a> <a id="2884" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2859" class="Bound">L</a> <a id="2886" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="2888" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2861" class="Bound">Lâ€²</a>
    <a id="2895" class="Symbol">â†’</a> <a id="2897" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2864" class="Bound">M</a> <a id="2899" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="2901" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2866" class="Bound">Mâ€²</a>
      <a id="2910" class="Comment">-----------------</a>
    <a id="2932" class="Symbol">â†’</a> <a id="2934" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2859" class="Bound">L</a> <a id="2936" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="2938" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2864" class="Bound">M</a> <a id="2940" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="2942" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2861" class="Bound">Lâ€²</a> <a id="2945" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="2947" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2866" class="Bound">Mâ€²</a>

  <a id="_â‡›_.pbeta"></a><a id="2953" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2953" class="InductiveConstructor">pbeta</a> <a id="2959" class="Symbol">:</a> <a id="2961" class="Symbol">âˆ€{</a><a id="2963" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2963" class="Bound">Î“</a><a id="2964" class="Symbol">}{</a><a id="2966" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2966" class="Bound">N</a> <a id="2968" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2968" class="Bound">Nâ€²</a>  <a id="2972" class="Symbol">:</a> <a id="2974" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2963" class="Bound">Î“</a> <a id="2976" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">,</a> <a id="2978" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a> <a id="2980" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="2982" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="2983" class="Symbol">}{</a><a id="2985" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2985" class="Bound">M</a> <a id="2987" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2987" class="Bound">Mâ€²</a> <a id="2990" class="Symbol">:</a> <a id="2992" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2963" class="Bound">Î“</a> <a id="2994" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="2996" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="2997" class="Symbol">}</a>
    <a id="3003" class="Symbol">â†’</a> <a id="3005" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2966" class="Bound">N</a> <a id="3007" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="3009" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2968" class="Bound">Nâ€²</a>
    <a id="3016" class="Symbol">â†’</a> <a id="3018" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2985" class="Bound">M</a> <a id="3020" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="3022" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2987" class="Bound">Mâ€²</a>
      <a id="3031" class="Comment">-----------------------</a>
    <a id="3059" class="Symbol">â†’</a> <a id="3061" class="Symbol">(</a><a id="3062" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="3064" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2966" class="Bound">N</a><a id="3065" class="Symbol">)</a> <a id="3067" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="3069" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2985" class="Bound">M</a>  <a id="3072" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a>  <a id="3075" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2968" class="Bound">Nâ€²</a> <a id="3078" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="3080" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2987" class="Bound">Mâ€²</a> <a id="3083" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">]</a>
</pre>{% endraw %}The first three rules are congruences that reduce each of their
parts simultaneously. The last rule reduces a lambda term and
term in parallel followed by a beta step.

We remark that the `pabs`, `papp`, and `pbeta` rules perform reduction
on all their subexpressions simultaneously. Also, the `pabs` rule is
akin to the `Î¶` rule and `pbeta` is akin to `Î²`.

Parallel reduction is reflexive.

{% raw %}<pre class="Agda"><a id="par-refl"></a><a id="3486" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a> <a id="3495" class="Symbol">:</a> <a id="3497" class="Symbol">âˆ€{</a><a id="3499" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3499" class="Bound">Î“</a> <a id="3501" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3501" class="Bound">A</a><a id="3502" class="Symbol">}{</a><a id="3504" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3504" class="Bound">M</a> <a id="3506" class="Symbol">:</a> <a id="3508" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3499" class="Bound">Î“</a> <a id="3510" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="3512" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3501" class="Bound">A</a><a id="3513" class="Symbol">}</a> <a id="3515" class="Symbol">â†’</a> <a id="3517" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3504" class="Bound">M</a> <a id="3519" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="3521" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3504" class="Bound">M</a>
<a id="3523" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a> <a id="3532" class="Symbol">{</a><a id="3533" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3533" class="Bound">Î“</a><a id="3534" class="Symbol">}</a> <a id="3536" class="Symbol">{</a><a id="3537" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3537" class="Bound">A</a><a id="3538" class="Symbol">}</a> <a id="3540" class="Symbol">{</a><a id="3541" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="3543" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3543" class="Bound">x</a><a id="3544" class="Symbol">}</a> <a id="3546" class="Symbol">=</a> <a id="3548" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a>
<a id="3553" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a> <a id="3562" class="Symbol">{</a><a id="3563" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3563" class="Bound">Î“</a><a id="3564" class="Symbol">}</a> <a id="3566" class="Symbol">{</a><a id="3567" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="3568" class="Symbol">}</a> <a id="3570" class="Symbol">{</a><a id="3571" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="3573" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3573" class="Bound">N</a><a id="3574" class="Symbol">}</a> <a id="3576" class="Symbol">=</a> <a id="3578" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="3583" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a>
<a id="3592" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a> <a id="3601" class="Symbol">{</a><a id="3602" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3602" class="Bound">Î“</a><a id="3603" class="Symbol">}</a> <a id="3605" class="Symbol">{</a><a id="3606" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="3607" class="Symbol">}</a> <a id="3609" class="Symbol">{</a><a id="3610" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3610" class="Bound">L</a> <a id="3612" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="3614" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3614" class="Bound">M</a><a id="3615" class="Symbol">}</a> <a id="3617" class="Symbol">=</a> <a id="3619" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="3624" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a> <a id="3633" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a>
</pre>{% endraw %}We define the sequences of parallel reduction as follows.

{% raw %}<pre class="Agda"><a id="3709" class="Keyword">infix</a>  <a id="3716" class="Number">2</a> <a id="3718" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">_â‡›*_</a>
<a id="3723" class="Keyword">infixr</a> <a id="3730" class="Number">2</a> <a id="3732" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">_â‡›âŸ¨_âŸ©_</a>
<a id="3739" class="Keyword">infix</a>  <a id="3746" class="Number">3</a> <a id="3748" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3807" class="InductiveConstructor Operator">_âˆ</a>

<a id="3752" class="Keyword">data</a> <a id="_â‡›*_"></a><a id="3757" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">_â‡›*_</a> <a id="3762" class="Symbol">:</a> <a id="3764" class="Symbol">âˆ€</a> <a id="3766" class="Symbol">{</a><a id="3767" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3767" class="Bound">Î“</a> <a id="3769" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3769" class="Bound">A</a><a id="3770" class="Symbol">}</a> <a id="3772" class="Symbol">â†’</a> <a id="3774" class="Symbol">(</a><a id="3775" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3767" class="Bound">Î“</a> <a id="3777" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="3779" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3769" class="Bound">A</a><a id="3780" class="Symbol">)</a> <a id="3782" class="Symbol">â†’</a> <a id="3784" class="Symbol">(</a><a id="3785" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3767" class="Bound">Î“</a> <a id="3787" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="3789" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3769" class="Bound">A</a><a id="3790" class="Symbol">)</a> <a id="3792" class="Symbol">â†’</a> <a id="3794" class="PrimitiveType">Set</a> <a id="3798" class="Keyword">where</a>

  <a id="_â‡›*_._âˆ"></a><a id="3807" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3807" class="InductiveConstructor Operator">_âˆ</a> <a id="3810" class="Symbol">:</a> <a id="3812" class="Symbol">âˆ€</a> <a id="3814" class="Symbol">{</a><a id="3815" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3815" class="Bound">Î“</a> <a id="3817" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3817" class="Bound">A</a><a id="3818" class="Symbol">}</a> <a id="3820" class="Symbol">(</a><a id="3821" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3821" class="Bound">M</a> <a id="3823" class="Symbol">:</a> <a id="3825" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3815" class="Bound">Î“</a> <a id="3827" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="3829" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3817" class="Bound">A</a><a id="3830" class="Symbol">)</a>
      <a id="3838" class="Comment">--------</a>
    <a id="3851" class="Symbol">â†’</a> <a id="3853" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3821" class="Bound">M</a> <a id="3855" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="3858" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3821" class="Bound">M</a>

  <a id="_â‡›*_._â‡›âŸ¨_âŸ©_"></a><a id="3863" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">_â‡›âŸ¨_âŸ©_</a> <a id="3870" class="Symbol">:</a> <a id="3872" class="Symbol">âˆ€</a> <a id="3874" class="Symbol">{</a><a id="3875" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3875" class="Bound">Î“</a> <a id="3877" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3877" class="Bound">A</a><a id="3878" class="Symbol">}</a> <a id="3880" class="Symbol">(</a><a id="3881" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3881" class="Bound">L</a> <a id="3883" class="Symbol">:</a> <a id="3885" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3875" class="Bound">Î“</a> <a id="3887" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="3889" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3877" class="Bound">A</a><a id="3890" class="Symbol">)</a> <a id="3892" class="Symbol">{</a><a id="3893" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3893" class="Bound">M</a> <a id="3895" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3895" class="Bound">N</a> <a id="3897" class="Symbol">:</a> <a id="3899" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3875" class="Bound">Î“</a> <a id="3901" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="3903" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3877" class="Bound">A</a><a id="3904" class="Symbol">}</a>
    <a id="3910" class="Symbol">â†’</a> <a id="3912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3881" class="Bound">L</a> <a id="3914" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="3916" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3893" class="Bound">M</a>
    <a id="3922" class="Symbol">â†’</a> <a id="3924" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3893" class="Bound">M</a> <a id="3926" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="3929" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3895" class="Bound">N</a>
      <a id="3937" class="Comment">---------</a>
    <a id="3951" class="Symbol">â†’</a> <a id="3953" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3881" class="Bound">L</a> <a id="3955" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="3958" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3895" class="Bound">N</a>
</pre>{% endraw %}

#### Exercise `par-diamond-eg` (practice)

Revisit the counter example to the diamond property for reduction by
showing that the diamond property holds for parallel reduction in that
case.

{% raw %}<pre class="Agda"><a id="4160" class="Comment">-- Your code goes here</a>
</pre>{% endraw %}

## Equivalence between parallel reduction and reduction

Here we prove that for any `M` and `N`, `M â‡›* N` if and only if `M â€”â†  N`.
The only-if direction is particularly easy. We start by showing
that if `M â€”â†’ N`, then `M â‡› N`. The proof is by induction on
the reduction `M â€”â†’ N`.

{% raw %}<pre class="Agda"><a id="beta-par"></a><a id="4474" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4474" class="Function">beta-par</a> <a id="4483" class="Symbol">:</a> <a id="4485" class="Symbol">âˆ€{</a><a id="4487" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4487" class="Bound">Î“</a> <a id="4489" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4489" class="Bound">A</a><a id="4490" class="Symbol">}{</a><a id="4492" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4492" class="Bound">M</a> <a id="4494" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4494" class="Bound">N</a> <a id="4496" class="Symbol">:</a> <a id="4498" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4487" class="Bound">Î“</a> <a id="4500" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="4502" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4489" class="Bound">A</a><a id="4503" class="Symbol">}</a>
  <a id="4507" class="Symbol">â†’</a> <a id="4509" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4492" class="Bound">M</a> <a id="4511" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9948" class="Datatype Operator">â€”â†’</a> <a id="4514" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4494" class="Bound">N</a>
    <a id="4520" class="Comment">------</a>
  <a id="4529" class="Symbol">â†’</a> <a id="4531" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4492" class="Bound">M</a> <a id="4533" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="4535" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4494" class="Bound">N</a>
<a id="4537" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4474" class="Function">beta-par</a> <a id="4546" class="Symbol">{</a><a id="4547" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4547" class="Bound">Î“</a><a id="4548" class="Symbol">}</a> <a id="4550" class="Symbol">{</a><a id="4551" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="4552" class="Symbol">}</a> <a id="4554" class="Symbol">{</a><a id="4555" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4555" class="Bound">L</a> <a id="4557" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="4559" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4559" class="Bound">M</a><a id="4560" class="Symbol">}</a> <a id="4562" class="Symbol">(</a><a id="4563" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#9998" class="InductiveConstructor">Î¾â‚</a> <a id="4566" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4566" class="Bound">r</a><a id="4567" class="Symbol">)</a> <a id="4569" class="Symbol">=</a> <a id="4571" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="4576" class="Symbol">(</a><a id="4577" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4474" class="Function">beta-par</a> <a id="4586" class="Symbol">{</a><a id="4587" class="Argument">M</a> <a id="4589" class="Symbol">=</a> <a id="4591" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4555" class="Bound">L</a><a id="4592" class="Symbol">}</a> <a id="4594" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4566" class="Bound">r</a><a id="4595" class="Symbol">)</a> <a id="4597" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a>
<a id="4606" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4474" class="Function">beta-par</a> <a id="4615" class="Symbol">{</a><a id="4616" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4616" class="Bound">Î“</a><a id="4617" class="Symbol">}</a> <a id="4619" class="Symbol">{</a><a id="4620" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="4621" class="Symbol">}</a> <a id="4623" class="Symbol">{</a><a id="4624" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4624" class="Bound">L</a> <a id="4626" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="4628" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4628" class="Bound">M</a><a id="4629" class="Symbol">}</a> <a id="4631" class="Symbol">(</a><a id="4632" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10088" class="InductiveConstructor">Î¾â‚‚</a> <a id="4635" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4635" class="Bound">r</a><a id="4636" class="Symbol">)</a> <a id="4638" class="Symbol">=</a> <a id="4640" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="4645" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a> <a id="4654" class="Symbol">(</a><a id="4655" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4474" class="Function">beta-par</a> <a id="4664" class="Symbol">{</a><a id="4665" class="Argument">M</a> <a id="4667" class="Symbol">=</a> <a id="4669" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4628" class="Bound">M</a><a id="4670" class="Symbol">}</a> <a id="4672" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4635" class="Bound">r</a><a id="4673" class="Symbol">)</a>
<a id="4675" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4474" class="Function">beta-par</a> <a id="4684" class="Symbol">{</a><a id="4685" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4685" class="Bound">Î“</a><a id="4686" class="Symbol">}</a> <a id="4688" class="Symbol">{</a><a id="4689" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="4690" class="Symbol">}</a> <a id="4692" class="Symbol">{(</a><a id="4694" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="4696" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4696" class="Bound">N</a><a id="4697" class="Symbol">)</a> <a id="4699" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="4701" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4701" class="Bound">M</a><a id="4702" class="Symbol">}</a> <a id="4704" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10178" class="InductiveConstructor">Î²</a> <a id="4706" class="Symbol">=</a> <a id="4708" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2953" class="InductiveConstructor">pbeta</a> <a id="4714" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a> <a id="4723" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3486" class="Function">par-refl</a>
<a id="4732" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4474" class="Function">beta-par</a> <a id="4741" class="Symbol">{</a><a id="4742" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4742" class="Bound">Î“</a><a id="4743" class="Symbol">}</a> <a id="4745" class="Symbol">{</a><a id="4746" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="4747" class="Symbol">}</a> <a id="4749" class="Symbol">{</a><a id="4750" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="4752" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4752" class="Bound">N</a><a id="4753" class="Symbol">}</a> <a id="4755" class="Symbol">(</a><a id="4756" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10286" class="InductiveConstructor">Î¶</a> <a id="4758" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4758" class="Bound">r</a><a id="4759" class="Symbol">)</a> <a id="4761" class="Symbol">=</a> <a id="4763" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="4768" class="Symbol">(</a><a id="4769" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4474" class="Function">beta-par</a> <a id="4778" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4758" class="Bound">r</a><a id="4779" class="Symbol">)</a>
</pre>{% endraw %}
With this lemma in hand we complete the only-if direction,
that `M â€”â†  N` implies `M â‡›* N`. The proof is a straightforward
induction on the reduction sequence `M â€”â†  N`.

{% raw %}<pre class="Agda"><a id="betas-pars"></a><a id="4959" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4959" class="Function">betas-pars</a> <a id="4970" class="Symbol">:</a> <a id="4972" class="Symbol">âˆ€{</a><a id="4974" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4974" class="Bound">Î“</a> <a id="4976" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4976" class="Bound">A</a><a id="4977" class="Symbol">}</a> <a id="4979" class="Symbol">{</a><a id="4980" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4980" class="Bound">M</a> <a id="4982" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4982" class="Bound">N</a> <a id="4984" class="Symbol">:</a> <a id="4986" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4974" class="Bound">Î“</a> <a id="4988" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="4990" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4976" class="Bound">A</a><a id="4991" class="Symbol">}</a>
  <a id="4995" class="Symbol">â†’</a> <a id="4997" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4980" class="Bound">M</a> <a id="4999" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11068" class="Datatype Operator">â€”â† </a> <a id="5002" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4982" class="Bound">N</a>
    <a id="5008" class="Comment">------</a>
  <a id="5017" class="Symbol">â†’</a> <a id="5019" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4980" class="Bound">M</a> <a id="5021" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="5024" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4982" class="Bound">N</a>
<a id="5026" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4959" class="Function">betas-pars</a> <a id="5037" class="Symbol">{</a><a id="5038" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5038" class="Bound">Î“</a><a id="5039" class="Symbol">}</a> <a id="5041" class="Symbol">{</a><a id="5042" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5042" class="Bound">A</a><a id="5043" class="Symbol">}</a> <a id="5045" class="Symbol">{</a><a id="5046" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5046" class="Bound">Mâ‚</a><a id="5048" class="Symbol">}</a> <a id="5050" class="Symbol">{</a><a id="5051" class="DottedPattern Symbol">.</a><a id="5052" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5046" class="DottedPattern Bound">Mâ‚</a><a id="5054" class="Symbol">}</a> <a id="5056" class="Symbol">(</a><a id="5057" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5046" class="Bound">Mâ‚</a> <a id="5060" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11118" class="InductiveConstructor Operator">âˆ</a><a id="5061" class="Symbol">)</a> <a id="5063" class="Symbol">=</a> <a id="5065" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5046" class="Bound">Mâ‚</a> <a id="5068" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3807" class="InductiveConstructor Operator">âˆ</a>
<a id="5070" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4959" class="Function">betas-pars</a> <a id="5081" class="Symbol">{</a><a id="5082" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5082" class="Bound">Î“</a><a id="5083" class="Symbol">}</a> <a id="5085" class="Symbol">{</a><a id="5086" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5086" class="Bound">A</a><a id="5087" class="Symbol">}</a> <a id="5089" class="Symbol">{</a><a id="5090" class="DottedPattern Symbol">.</a><a id="5091" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5099" class="DottedPattern Bound">L</a><a id="5092" class="Symbol">}</a> <a id="5094" class="Symbol">{</a><a id="5095" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5095" class="Bound">N</a><a id="5096" class="Symbol">}</a> <a id="5098" class="Symbol">(</a><a id="5099" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5099" class="Bound">L</a> <a id="5101" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11174" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="5105" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5105" class="Bound">b</a> <a id="5107" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11174" class="InductiveConstructor Operator">âŸ©</a> <a id="5109" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5109" class="Bound">bs</a><a id="5111" class="Symbol">)</a> <a id="5113" class="Symbol">=</a>
   <a id="5118" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5099" class="Bound">L</a> <a id="5120" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">â‡›âŸ¨</a> <a id="5123" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4474" class="Function">beta-par</a> <a id="5132" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5105" class="Bound">b</a> <a id="5134" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">âŸ©</a> <a id="5136" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4959" class="Function">betas-pars</a> <a id="5147" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5109" class="Bound">bs</a>
</pre>{% endraw %}
Now for the other direction, that `M â‡›* N` implies `M â€”â†  N`.  The
proof of this direction is a bit different because it's not the case
that `M â‡› N` implies `M â€”â†’ N`. After all, `M â‡› N` performs many
reductions. So instead we shall prove that `M â‡› N` implies `M â€”â†  N`.

{% raw %}<pre class="Agda"><a id="par-betas"></a><a id="5428" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="5438" class="Symbol">:</a> <a id="5440" class="Symbol">âˆ€{</a><a id="5442" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5442" class="Bound">Î“</a> <a id="5444" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5444" class="Bound">A</a><a id="5445" class="Symbol">}{</a><a id="5447" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5447" class="Bound">M</a> <a id="5449" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5449" class="Bound">N</a> <a id="5451" class="Symbol">:</a> <a id="5453" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5442" class="Bound">Î“</a> <a id="5455" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="5457" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5444" class="Bound">A</a><a id="5458" class="Symbol">}</a>
  <a id="5462" class="Symbol">â†’</a> <a id="5464" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5447" class="Bound">M</a> <a id="5466" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="5468" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5449" class="Bound">N</a>
    <a id="5474" class="Comment">------</a>
  <a id="5483" class="Symbol">â†’</a> <a id="5485" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5447" class="Bound">M</a> <a id="5487" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11068" class="Datatype Operator">â€”â† </a> <a id="5490" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5449" class="Bound">N</a>
<a id="5492" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="5502" class="Symbol">{</a><a id="5503" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5503" class="Bound">Î“</a><a id="5504" class="Symbol">}</a> <a id="5506" class="Symbol">{</a><a id="5507" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5507" class="Bound">A</a><a id="5508" class="Symbol">}</a> <a id="5510" class="Symbol">{</a><a id="5511" class="DottedPattern Symbol">.(</a><a id="5513" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="DottedPattern InductiveConstructor Operator">`</a> <a id="5515" class="DottedPattern Symbol">_)</a><a id="5517" class="Symbol">}</a> <a id="5519" class="Symbol">(</a><a id="5520" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a><a id="5524" class="Symbol">{</a><a id="5525" class="Argument">x</a> <a id="5527" class="Symbol">=</a> <a id="5529" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5529" class="Bound">x</a><a id="5530" class="Symbol">})</a> <a id="5533" class="Symbol">=</a> <a id="5535" class="Symbol">(</a><a id="5536" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="5538" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5529" class="Bound">x</a><a id="5539" class="Symbol">)</a> <a id="5541" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11118" class="InductiveConstructor Operator">âˆ</a>
<a id="5543" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="5553" class="Symbol">{</a><a id="5554" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5554" class="Bound">Î“</a><a id="5555" class="Symbol">}</a> <a id="5557" class="Symbol">{</a><a id="5558" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="5559" class="Symbol">}</a> <a id="5561" class="Symbol">{</a><a id="5562" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="5564" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5564" class="Bound">N</a><a id="5565" class="Symbol">}</a> <a id="5567" class="Symbol">(</a><a id="5568" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="5573" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5573" class="Bound">p</a><a id="5574" class="Symbol">)</a> <a id="5576" class="Symbol">=</a> <a id="5578" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#23928" class="Function">abs-cong</a> <a id="5587" class="Symbol">(</a><a id="5588" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="5598" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5573" class="Bound">p</a><a id="5599" class="Symbol">)</a>
<a id="5601" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="5611" class="Symbol">{</a><a id="5612" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5612" class="Bound">Î“</a><a id="5613" class="Symbol">}</a> <a id="5615" class="Symbol">{</a><a id="5616" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="5617" class="Symbol">}</a> <a id="5619" class="Symbol">{</a><a id="5620" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5620" class="Bound">L</a> <a id="5622" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="5624" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5624" class="Bound">M</a><a id="5625" class="Symbol">}</a> <a id="5627" class="Symbol">(</a><a id="5628" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="5633" class="Symbol">{</a><a id="5634" class="Argument">L</a> <a id="5636" class="Symbol">=</a> <a id="5638" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5620" class="Bound">L</a><a id="5639" class="Symbol">}{</a><a id="5641" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5641" class="Bound">Lâ€²</a><a id="5643" class="Symbol">}{</a><a id="5645" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5624" class="Bound">M</a><a id="5646" class="Symbol">}{</a><a id="5648" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5648" class="Bound">Mâ€²</a><a id="5650" class="Symbol">}</a> <a id="5652" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5652" class="Bound">pâ‚</a> <a id="5655" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5655" class="Bound">pâ‚‚</a><a id="5657" class="Symbol">)</a> <a id="5659" class="Symbol">=</a>
    <a id="5665" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11274" class="Function Operator">begin</a>
    <a id="5675" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5620" class="Bound">L</a> <a id="5677" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="5679" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5624" class="Bound">M</a>   <a id="5683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22017" class="Function Operator">â€”â† âŸ¨</a> <a id="5687" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22931" class="Function">appL-cong</a><a id="5696" class="Symbol">{</a><a id="5697" class="Argument">M</a> <a id="5699" class="Symbol">=</a> <a id="5701" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5624" class="Bound">M</a><a id="5702" class="Symbol">}</a> <a id="5704" class="Symbol">(</a><a id="5705" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="5715" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5652" class="Bound">pâ‚</a><a id="5717" class="Symbol">)</a> <a id="5719" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22017" class="Function Operator">âŸ©</a>
    <a id="5725" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5641" class="Bound">Lâ€²</a> <a id="5728" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="5730" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5624" class="Bound">M</a>  <a id="5733" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22017" class="Function Operator">â€”â† âŸ¨</a> <a id="5737" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#23700" class="Function">appR-cong</a> <a id="5747" class="Symbol">(</a><a id="5748" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="5758" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5655" class="Bound">pâ‚‚</a><a id="5760" class="Symbol">)</a> <a id="5762" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22017" class="Function Operator">âŸ©</a>
    <a id="5768" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5641" class="Bound">Lâ€²</a> <a id="5771" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="5773" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5648" class="Bound">Mâ€²</a>
    <a id="5780" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11118" class="InductiveConstructor Operator">âˆ</a>
<a id="5782" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="5792" class="Symbol">{</a><a id="5793" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5793" class="Bound">Î“</a><a id="5794" class="Symbol">}</a> <a id="5796" class="Symbol">{</a><a id="5797" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="5798" class="Symbol">}</a> <a id="5800" class="Symbol">{(</a><a id="5802" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="5804" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5804" class="Bound">N</a><a id="5805" class="Symbol">)</a> <a id="5807" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="5809" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5809" class="Bound">M</a><a id="5810" class="Symbol">}</a> <a id="5812" class="Symbol">(</a><a id="5813" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2953" class="InductiveConstructor">pbeta</a><a id="5818" class="Symbol">{</a><a id="5819" class="Argument">Nâ€²</a> <a id="5822" class="Symbol">=</a> <a id="5824" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5824" class="Bound">Nâ€²</a><a id="5826" class="Symbol">}{</a><a id="5828" class="Argument">Mâ€²</a> <a id="5831" class="Symbol">=</a> <a id="5833" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5833" class="Bound">Mâ€²</a><a id="5835" class="Symbol">}</a> <a id="5837" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5837" class="Bound">pâ‚</a> <a id="5840" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5840" class="Bound">pâ‚‚</a><a id="5842" class="Symbol">)</a> <a id="5844" class="Symbol">=</a>
    <a id="5850" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11274" class="Function Operator">begin</a>
    <a id="5860" class="Symbol">(</a><a id="5861" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="5863" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5804" class="Bound">N</a><a id="5864" class="Symbol">)</a> <a id="5866" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="5868" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5809" class="Bound">M</a>                    <a id="5889" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22017" class="Function Operator">â€”â† âŸ¨</a> <a id="5893" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22931" class="Function">appL-cong</a><a id="5902" class="Symbol">{</a><a id="5903" class="Argument">M</a> <a id="5905" class="Symbol">=</a> <a id="5907" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5809" class="Bound">M</a><a id="5908" class="Symbol">}</a> <a id="5910" class="Symbol">(</a><a id="5911" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#23928" class="Function">abs-cong</a> <a id="5920" class="Symbol">(</a><a id="5921" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="5931" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5837" class="Bound">pâ‚</a><a id="5933" class="Symbol">))</a> <a id="5936" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22017" class="Function Operator">âŸ©</a>
    <a id="5942" class="Symbol">(</a><a id="5943" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="5945" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5824" class="Bound">Nâ€²</a><a id="5947" class="Symbol">)</a> <a id="5949" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="5951" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5809" class="Bound">M</a>                   <a id="5971" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22017" class="Function Operator">â€”â† âŸ¨</a> <a id="5975" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#23700" class="Function">appR-cong</a><a id="5984" class="Symbol">{</a><a id="5985" class="Argument">L</a> <a id="5987" class="Symbol">=</a> <a id="5989" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="5991" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5824" class="Bound">Nâ€²</a><a id="5993" class="Symbol">}</a> <a id="5995" class="Symbol">(</a><a id="5996" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="6006" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5840" class="Bound">pâ‚‚</a><a id="6008" class="Symbol">)</a>  <a id="6011" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#22017" class="Function Operator">âŸ©</a>
    <a id="6017" class="Symbol">(</a><a id="6018" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="6020" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5824" class="Bound">Nâ€²</a><a id="6022" class="Symbol">)</a> <a id="6024" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="6026" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5833" class="Bound">Mâ€²</a>                  <a id="6046" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11174" class="InductiveConstructor Operator">â€”â†’âŸ¨</a> <a id="6050" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#10178" class="InductiveConstructor">Î²</a> <a id="6052" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11174" class="InductiveConstructor Operator">âŸ©</a>
     <a id="6059" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5824" class="Bound">Nâ€²</a> <a id="6062" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="6064" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5833" class="Bound">Mâ€²</a> <a id="6067" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">]</a>
    <a id="6073" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11118" class="InductiveConstructor Operator">âˆ</a>
</pre>{% endraw %}
The proof is by induction on `M â‡› N`.

* Suppose `x â‡› x`. We immediately have `x â€”â†  x`.

* Suppose `Æ› N â‡› Æ› Nâ€²` because `N â‡› Nâ€²`. By the induction hypothesis
  we have `N â€”â†  Nâ€²`. We conclude that `Æ› N â€”â†  Æ› Nâ€²` because
  `â€”â† ` is a congruence.

* Suppose `L Â· M â‡› Lâ€² Â· Mâ€²` because `L â‡› Lâ€²` and `M â‡› Mâ€²`.
  By the induction hypothesis, we have `L â€”â†  Lâ€²` and `M â€”â†  Mâ€²`.
  So `L Â· M â€”â†  Lâ€² Â· M` and then `Lâ€² Â· M  â€”â†  Lâ€² Â· Mâ€²`
  because `â€”â† ` is a congruence.

* Suppose `(Æ› N) Â· M  â‡›  Nâ€² [ Mâ€² ]` because `N â‡› Nâ€²` and `M â‡› Mâ€²`.
  By similar reasoning, we have
  `(Æ› N) Â· M â€”â†  (Æ› Nâ€²) Â· Mâ€²`
  which we can following with the Î² reduction
  `(Æ› Nâ€²) Â· Mâ€² â€”â†’ Nâ€² [ Mâ€² ]`.

With this lemma in hand, we complete the proof that `M â‡›* N` implies
`M â€”â†  N` with a simple induction on `M â‡›* N`.

{% raw %}<pre class="Agda"><a id="pars-betas"></a><a id="6857" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6857" class="Function">pars-betas</a> <a id="6868" class="Symbol">:</a> <a id="6870" class="Symbol">âˆ€{</a><a id="6872" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6872" class="Bound">Î“</a> <a id="6874" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6874" class="Bound">A</a><a id="6875" class="Symbol">}</a> <a id="6877" class="Symbol">{</a><a id="6878" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6878" class="Bound">M</a> <a id="6880" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6880" class="Bound">N</a> <a id="6882" class="Symbol">:</a> <a id="6884" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6872" class="Bound">Î“</a> <a id="6886" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="6888" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6874" class="Bound">A</a><a id="6889" class="Symbol">}</a>
  <a id="6893" class="Symbol">â†’</a> <a id="6895" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6878" class="Bound">M</a> <a id="6897" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="6900" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6880" class="Bound">N</a>
    <a id="6906" class="Comment">------</a>
  <a id="6915" class="Symbol">â†’</a> <a id="6917" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6878" class="Bound">M</a> <a id="6919" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11068" class="Datatype Operator">â€”â† </a> <a id="6922" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6880" class="Bound">N</a>
<a id="6924" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6857" class="Function">pars-betas</a> <a id="6935" class="Symbol">(</a><a id="6936" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6936" class="Bound">Mâ‚</a> <a id="6939" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3807" class="InductiveConstructor Operator">âˆ</a><a id="6940" class="Symbol">)</a> <a id="6942" class="Symbol">=</a> <a id="6944" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6936" class="Bound">Mâ‚</a> <a id="6947" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11118" class="InductiveConstructor Operator">âˆ</a>
<a id="6949" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6857" class="Function">pars-betas</a> <a id="6960" class="Symbol">(</a><a id="6961" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6961" class="Bound">L</a> <a id="6963" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">â‡›âŸ¨</a> <a id="6966" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6966" class="Bound">p</a> <a id="6968" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">âŸ©</a> <a id="6970" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6970" class="Bound">ps</a><a id="6972" class="Symbol">)</a> <a id="6974" class="Symbol">=</a> <a id="6976" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#21747" class="Function">â€”â† -trans</a> <a id="6985" class="Symbol">(</a><a id="6986" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#5428" class="Function">par-betas</a> <a id="6996" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6966" class="Bound">p</a><a id="6997" class="Symbol">)</a> <a id="6999" class="Symbol">(</a><a id="7000" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6857" class="Function">pars-betas</a> <a id="7011" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6970" class="Bound">ps</a><a id="7013" class="Symbol">)</a>
</pre>{% endraw %}

## Substitution lemma for parallel reduction

Our next goal is the prove the diamond property for parallel
reduction. But to do that, we need to prove that substitution
respects parallel reduction. That is, if
`N â‡› Nâ€²` and `M â‡› Mâ€²`, then `N [ M ] â‡› Nâ€² [ Mâ€² ]`.
We cannot prove this directly by induction, so we
generalize it to: if `N â‡› Nâ€²` and
the substitution `Ïƒ` pointwise parallel reduces to `Ï„`,
then `subst Ïƒ N â‡› subst Ï„ Nâ€²`. We define the notion
of pointwise parallel reduction as follows.

{% raw %}<pre class="Agda"><a id="par-subst"></a><a id="7523" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7523" class="Function">par-subst</a> <a id="7533" class="Symbol">:</a> <a id="7535" class="Symbol">âˆ€{</a><a id="7537" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7537" class="Bound">Î“</a> <a id="7539" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7539" class="Bound">Î”</a><a id="7540" class="Symbol">}</a> <a id="7542" class="Symbol">â†’</a> <a id="7544" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="7550" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7537" class="Bound">Î“</a> <a id="7552" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7539" class="Bound">Î”</a> <a id="7554" class="Symbol">â†’</a> <a id="7556" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="7562" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7537" class="Bound">Î“</a> <a id="7564" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7539" class="Bound">Î”</a> <a id="7566" class="Symbol">â†’</a> <a id="7568" class="PrimitiveType">Set</a>
<a id="7572" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7523" class="Function">par-subst</a> <a id="7582" class="Symbol">{</a><a id="7583" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7583" class="Bound">Î“</a><a id="7584" class="Symbol">}{</a><a id="7586" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7586" class="Bound">Î”</a><a id="7587" class="Symbol">}</a> <a id="7589" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7589" class="Bound">Ïƒ</a> <a id="7591" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7591" class="Bound">Ïƒâ€²</a> <a id="7594" class="Symbol">=</a> <a id="7596" class="Symbol">âˆ€{</a><a id="7598" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7598" class="Bound">A</a><a id="7599" class="Symbol">}{</a><a id="7601" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7601" class="Bound">x</a> <a id="7603" class="Symbol">:</a> <a id="7605" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7583" class="Bound">Î“</a> <a id="7607" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3521" class="Datatype Operator">âˆ‹</a> <a id="7609" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7598" class="Bound">A</a><a id="7610" class="Symbol">}</a> <a id="7612" class="Symbol">â†’</a> <a id="7614" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7589" class="Bound">Ïƒ</a> <a id="7616" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7601" class="Bound">x</a> <a id="7618" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="7620" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7591" class="Bound">Ïƒâ€²</a> <a id="7623" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7601" class="Bound">x</a>
</pre>{% endraw %}
Because substitution depends on the extension function `exts`, which
in turn relies on `rename`, we start with a version of the
substitution lemma, called `par-rename`, that is specialized to
renamings.  The proof of `par-rename` relies on the fact that renaming
and substitution commute with one another, which is a lemma that we
import from Chapter [Substitution]({{ site.baseurl }}/Substitution/)
and restate here.

{% raw %}<pre class="Agda"><a id="rename-subst-commute"></a><a id="8053" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8053" class="Function">rename-subst-commute</a> <a id="8074" class="Symbol">:</a> <a id="8076" class="Symbol">âˆ€{</a><a id="8078" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8078" class="Bound">Î“</a> <a id="8080" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8080" class="Bound">Î”</a><a id="8081" class="Symbol">}{</a><a id="8083" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8083" class="Bound">N</a> <a id="8085" class="Symbol">:</a> <a id="8087" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8078" class="Bound">Î“</a> <a id="8089" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">,</a> <a id="8091" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a> <a id="8093" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="8095" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="8096" class="Symbol">}{</a><a id="8098" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8098" class="Bound">M</a> <a id="8100" class="Symbol">:</a> <a id="8102" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8078" class="Bound">Î“</a> <a id="8104" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="8106" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="8107" class="Symbol">}{</a><a id="8109" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8109" class="Bound">Ï</a> <a id="8111" class="Symbol">:</a> <a id="8113" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2192" class="Function">Rename</a> <a id="8120" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8078" class="Bound">Î“</a> <a id="8122" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8080" class="Bound">Î”</a> <a id="8124" class="Symbol">}</a>
    <a id="8130" class="Symbol">â†’</a> <a id="8132" class="Symbol">(</a><a id="8133" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6235" class="Function">rename</a> <a id="8140" class="Symbol">(</a><a id="8141" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#5925" class="Function">ext</a> <a id="8145" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8109" class="Bound">Ï</a><a id="8146" class="Symbol">)</a> <a id="8148" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8083" class="Bound">N</a><a id="8149" class="Symbol">)</a> <a id="8151" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="8153" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6235" class="Function">rename</a> <a id="8160" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8109" class="Bound">Ï</a> <a id="8162" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8098" class="Bound">M</a> <a id="8164" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">]</a> <a id="8166" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="8168" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6235" class="Function">rename</a> <a id="8175" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8109" class="Bound">Ï</a> <a id="8177" class="Symbol">(</a><a id="8178" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8083" class="Bound">N</a> <a id="8180" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="8182" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8098" class="Bound">M</a> <a id="8184" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">]</a><a id="8185" class="Symbol">)</a>
<a id="8187" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8053" class="Function">rename-subst-commute</a> <a id="8208" class="Symbol">{</a><a id="8209" class="Argument">N</a> <a id="8211" class="Symbol">=</a> <a id="8213" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8213" class="Bound">N</a><a id="8214" class="Symbol">}</a> <a id="8216" class="Symbol">=</a> <a id="8218" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#27893" class="Function">plfa.part2.Substitution.rename-subst-commute</a> <a id="8263" class="Symbol">{</a><a id="8264" class="Argument">N</a> <a id="8266" class="Symbol">=</a> <a id="8268" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8213" class="Bound">N</a><a id="8269" class="Symbol">}</a>
</pre>{% endraw %}
Now for the `par-rename` lemma.

{% raw %}<pre class="Agda"><a id="par-rename"></a><a id="8313" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a> <a id="8324" class="Symbol">:</a> <a id="8326" class="Symbol">âˆ€{</a><a id="8328" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8328" class="Bound">Î“</a> <a id="8330" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8330" class="Bound">Î”</a> <a id="8332" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8332" class="Bound">A</a><a id="8333" class="Symbol">}</a> <a id="8335" class="Symbol">{</a><a id="8336" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8336" class="Bound">Ï</a> <a id="8338" class="Symbol">:</a> <a id="8340" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2192" class="Function">Rename</a> <a id="8347" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8328" class="Bound">Î“</a> <a id="8349" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8330" class="Bound">Î”</a><a id="8350" class="Symbol">}</a> <a id="8352" class="Symbol">{</a><a id="8353" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8353" class="Bound">M</a> <a id="8355" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8355" class="Bound">Mâ€²</a> <a id="8358" class="Symbol">:</a> <a id="8360" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8328" class="Bound">Î“</a> <a id="8362" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="8364" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8332" class="Bound">A</a><a id="8365" class="Symbol">}</a>
  <a id="8369" class="Symbol">â†’</a> <a id="8371" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8353" class="Bound">M</a> <a id="8373" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="8375" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8355" class="Bound">Mâ€²</a>
    <a id="8382" class="Comment">------------------------</a>
  <a id="8409" class="Symbol">â†’</a> <a id="8411" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6235" class="Function">rename</a> <a id="8418" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8336" class="Bound">Ï</a> <a id="8420" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8353" class="Bound">M</a> <a id="8422" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="8424" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6235" class="Function">rename</a> <a id="8431" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8336" class="Bound">Ï</a> <a id="8433" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8355" class="Bound">Mâ€²</a>
<a id="8436" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a> <a id="8447" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a> <a id="8452" class="Symbol">=</a> <a id="8454" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a>
<a id="8459" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a> <a id="8470" class="Symbol">(</a><a id="8471" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="8476" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8476" class="Bound">p</a><a id="8477" class="Symbol">)</a> <a id="8479" class="Symbol">=</a> <a id="8481" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="8486" class="Symbol">(</a><a id="8487" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a> <a id="8498" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8476" class="Bound">p</a><a id="8499" class="Symbol">)</a>
<a id="8501" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a> <a id="8512" class="Symbol">(</a><a id="8513" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="8518" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8518" class="Bound">pâ‚</a> <a id="8521" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8521" class="Bound">pâ‚‚</a><a id="8523" class="Symbol">)</a> <a id="8525" class="Symbol">=</a> <a id="8527" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="8532" class="Symbol">(</a><a id="8533" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a> <a id="8544" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8518" class="Bound">pâ‚</a><a id="8546" class="Symbol">)</a> <a id="8548" class="Symbol">(</a><a id="8549" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a> <a id="8560" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8521" class="Bound">pâ‚‚</a><a id="8562" class="Symbol">)</a>
<a id="8564" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a> <a id="8575" class="Symbol">{</a><a id="8576" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8576" class="Bound">Î“</a><a id="8577" class="Symbol">}{</a><a id="8579" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8579" class="Bound">Î”</a><a id="8580" class="Symbol">}{</a><a id="8582" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8582" class="Bound">A</a><a id="8583" class="Symbol">}{</a><a id="8585" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8585" class="Bound">Ï</a><a id="8586" class="Symbol">}</a> <a id="8588" class="Symbol">(</a><a id="8589" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2953" class="InductiveConstructor">pbeta</a><a id="8594" class="Symbol">{</a><a id="8595" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8576" class="Bound">Î“</a><a id="8596" class="Symbol">}{</a><a id="8598" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8598" class="Bound">N</a><a id="8599" class="Symbol">}{</a><a id="8601" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8601" class="Bound">Nâ€²</a><a id="8603" class="Symbol">}{</a><a id="8605" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8605" class="Bound">M</a><a id="8606" class="Symbol">}{</a><a id="8608" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8608" class="Bound">Mâ€²</a><a id="8610" class="Symbol">}</a> <a id="8612" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8612" class="Bound">pâ‚</a> <a id="8615" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8615" class="Bound">pâ‚‚</a><a id="8617" class="Symbol">)</a>
    <a id="8623" class="Keyword">with</a> <a id="8628" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2953" class="InductiveConstructor">pbeta</a> <a id="8634" class="Symbol">(</a><a id="8635" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a><a id="8645" class="Symbol">{</a><a id="8646" class="Argument">Ï</a> <a id="8648" class="Symbol">=</a> <a id="8650" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#5925" class="Function">ext</a> <a id="8654" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8585" class="Bound">Ï</a><a id="8655" class="Symbol">}</a> <a id="8657" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8612" class="Bound">pâ‚</a><a id="8659" class="Symbol">)</a> <a id="8661" class="Symbol">(</a><a id="8662" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a><a id="8672" class="Symbol">{</a><a id="8673" class="Argument">Ï</a> <a id="8675" class="Symbol">=</a> <a id="8677" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8585" class="Bound">Ï</a><a id="8678" class="Symbol">}</a> <a id="8680" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8615" class="Bound">pâ‚‚</a><a id="8682" class="Symbol">)</a>
<a id="8684" class="Symbol">...</a> <a id="8688" class="Symbol">|</a> <a id="8690" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8690" class="Bound">G</a> <a id="8692" class="Keyword">rewrite</a> <a id="8700" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8053" class="Function">rename-subst-commute</a><a id="8720" class="Symbol">{</a><a id="8721" class="Bound">Î“</a><a id="8722" class="Symbol">}{</a><a id="8724" class="Bound">Î”</a><a id="8725" class="Symbol">}{</a><a id="8727" class="Bound">Nâ€²</a><a id="8729" class="Symbol">}{</a><a id="8731" class="Bound">Mâ€²</a><a id="8733" class="Symbol">}{</a><a id="8735" class="Bound">Ï</a><a id="8736" class="Symbol">}</a> <a id="8738" class="Symbol">=</a> <a id="8740" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8690" class="Bound">G</a>

</pre>{% endraw %}
The proof is by induction on `M â‡› Mâ€²`. The first four cases
are straightforward so we just consider the last one for `pbeta`.

* Suppose `(Æ› N) Â· M  â‡›  Nâ€² [ Mâ€² ]` because `N â‡› Nâ€²` and `M â‡› Mâ€²`.
  By the induction hypothesis, we have
  `rename (ext Ï) N â‡› rename (ext Ï) Nâ€²` and
  `rename Ï M â‡› rename Ï Mâ€²`.
  So by `pbeta` we have
  `(Æ› rename (ext Ï) N) Â· (rename Ï M) â‡› (rename (ext Ï) N) [ rename Ï M ]`.
  However, to conclude we instead need parallel reduction to
  `rename Ï (N [ M ])`. But thankfully, renaming and substitution
  commute with one another.


With the `par-rename` lemma in hand, it is straightforward to show
that extending substitutions preserves the pointwise parallel
reduction relation.

{% raw %}<pre class="Agda"><a id="par-subst-exts"></a><a id="9468" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9468" class="Function">par-subst-exts</a> <a id="9483" class="Symbol">:</a> <a id="9485" class="Symbol">âˆ€{</a><a id="9487" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9487" class="Bound">Î“</a> <a id="9489" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9489" class="Bound">Î”</a><a id="9490" class="Symbol">}</a> <a id="9492" class="Symbol">{</a><a id="9493" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9493" class="Bound">Ïƒ</a> <a id="9495" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9495" class="Bound">Ï„</a> <a id="9497" class="Symbol">:</a> <a id="9499" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="9505" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9487" class="Bound">Î“</a> <a id="9507" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9489" class="Bound">Î”</a><a id="9508" class="Symbol">}</a>
  <a id="9512" class="Symbol">â†’</a> <a id="9514" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7523" class="Function">par-subst</a> <a id="9524" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9493" class="Bound">Ïƒ</a> <a id="9526" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9495" class="Bound">Ï„</a>
    <a id="9532" class="Comment">------------------------------------------</a>
  <a id="9577" class="Symbol">â†’</a> <a id="9579" class="Symbol">âˆ€{</a><a id="9581" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9581" class="Bound">B</a><a id="9582" class="Symbol">}</a> <a id="9584" class="Symbol">â†’</a> <a id="9586" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7523" class="Function">par-subst</a> <a id="9596" class="Symbol">(</a><a id="9597" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="9602" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9493" class="Bound">Ïƒ</a> <a id="9604" class="Symbol">{</a><a id="9605" class="Argument">B</a> <a id="9607" class="Symbol">=</a> <a id="9609" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9581" class="Bound">B</a><a id="9610" class="Symbol">})</a> <a id="9613" class="Symbol">(</a><a id="9614" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="9619" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9495" class="Bound">Ï„</a><a id="9620" class="Symbol">)</a>
<a id="9622" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9468" class="Function">par-subst-exts</a> <a id="9637" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9637" class="Bound">s</a> <a id="9639" class="Symbol">{</a><a id="9640" class="Argument">x</a> <a id="9642" class="Symbol">=</a> <a id="9644" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a><a id="9645" class="Symbol">}</a> <a id="9647" class="Symbol">=</a> <a id="9649" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a>
<a id="9654" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9468" class="Function">par-subst-exts</a> <a id="9669" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9669" class="Bound">s</a> <a id="9671" class="Symbol">{</a><a id="9672" class="Argument">x</a> <a id="9674" class="Symbol">=</a> <a id="9676" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="9678" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9678" class="Bound">x</a><a id="9679" class="Symbol">}</a> <a id="9681" class="Symbol">=</a> <a id="9683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#8313" class="Function">par-rename</a> <a id="9694" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9669" class="Bound">s</a>
</pre>{% endraw %}
The next lemma that we need for proving that substitution respects
parallel reduction is the following which states that
simultaneoous substitution commutes with single substitution. We import this
lemma from Chapter [Substitution]({{ site.baseurl }}/Substitution/)
and restate it below.

{% raw %}<pre class="Agda"><a id="subst-commute"></a><a id="9994" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9994" class="Function">subst-commute</a> <a id="10008" class="Symbol">:</a> <a id="10010" class="Symbol">âˆ€{</a><a id="10012" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10012" class="Bound">Î“</a> <a id="10014" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10014" class="Bound">Î”</a><a id="10015" class="Symbol">}{</a><a id="10017" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10017" class="Bound">N</a> <a id="10019" class="Symbol">:</a> <a id="10021" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10012" class="Bound">Î“</a> <a id="10023" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">,</a> <a id="10025" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a> <a id="10027" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="10029" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="10030" class="Symbol">}{</a><a id="10032" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10032" class="Bound">M</a> <a id="10034" class="Symbol">:</a> <a id="10036" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10012" class="Bound">Î“</a> <a id="10038" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="10040" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="10041" class="Symbol">}{</a><a id="10043" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10043" class="Bound">Ïƒ</a> <a id="10045" class="Symbol">:</a> <a id="10047" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="10053" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10012" class="Bound">Î“</a> <a id="10055" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10014" class="Bound">Î”</a> <a id="10057" class="Symbol">}</a>
  <a id="10061" class="Symbol">â†’</a> <a id="10063" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6963" class="Function">subst</a> <a id="10069" class="Symbol">(</a><a id="10070" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="10075" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10043" class="Bound">Ïƒ</a><a id="10076" class="Symbol">)</a> <a id="10078" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10017" class="Bound">N</a> <a id="10080" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="10082" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6963" class="Function">subst</a> <a id="10088" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10043" class="Bound">Ïƒ</a> <a id="10090" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10032" class="Bound">M</a> <a id="10092" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">]</a> <a id="10094" href="Agda.Builtin.Equality.html#151" class="Datatype Operator">â‰¡</a> <a id="10096" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6963" class="Function">subst</a> <a id="10102" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10043" class="Bound">Ïƒ</a> <a id="10104" class="Symbol">(</a><a id="10105" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10017" class="Bound">N</a> <a id="10107" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="10109" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10032" class="Bound">M</a> <a id="10111" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">]</a><a id="10112" class="Symbol">)</a>
<a id="10114" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9994" class="Function">subst-commute</a> <a id="10128" class="Symbol">{</a><a id="10129" class="Argument">N</a> <a id="10131" class="Symbol">=</a> <a id="10133" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10133" class="Bound">N</a><a id="10134" class="Symbol">}</a> <a id="10136" class="Symbol">=</a> <a id="10138" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#26352" class="Function">plfa.part2.Substitution.subst-commute</a> <a id="10176" class="Symbol">{</a><a id="10177" class="Argument">N</a> <a id="10179" class="Symbol">=</a> <a id="10181" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10133" class="Bound">N</a><a id="10182" class="Symbol">}</a>
</pre>{% endraw %}
We are ready to prove that substitution respects parallel reduction.

{% raw %}<pre class="Agda"><a id="subst-par"></a><a id="10263" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="10273" class="Symbol">:</a> <a id="10275" class="Symbol">âˆ€{</a><a id="10277" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10277" class="Bound">Î“</a> <a id="10279" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10279" class="Bound">Î”</a> <a id="10281" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10281" class="Bound">A</a><a id="10282" class="Symbol">}</a> <a id="10284" class="Symbol">{</a><a id="10285" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10285" class="Bound">Ïƒ</a> <a id="10287" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10287" class="Bound">Ï„</a> <a id="10289" class="Symbol">:</a> <a id="10291" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Substitution.md %}{% raw %}#2405" class="Function">Subst</a> <a id="10297" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10277" class="Bound">Î“</a> <a id="10299" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10279" class="Bound">Î”</a><a id="10300" class="Symbol">}</a> <a id="10302" class="Symbol">{</a><a id="10303" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10303" class="Bound">M</a> <a id="10305" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10305" class="Bound">Mâ€²</a> <a id="10308" class="Symbol">:</a> <a id="10310" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10277" class="Bound">Î“</a> <a id="10312" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="10314" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10281" class="Bound">A</a><a id="10315" class="Symbol">}</a>
  <a id="10319" class="Symbol">â†’</a> <a id="10321" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7523" class="Function">par-subst</a> <a id="10331" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10285" class="Bound">Ïƒ</a> <a id="10333" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10287" class="Bound">Ï„</a>  <a id="10336" class="Symbol">â†’</a>  <a id="10339" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10303" class="Bound">M</a> <a id="10341" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="10343" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10305" class="Bound">Mâ€²</a>
    <a id="10350" class="Comment">--------------------------</a>
  <a id="10379" class="Symbol">â†’</a> <a id="10381" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6963" class="Function">subst</a> <a id="10387" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10285" class="Bound">Ïƒ</a> <a id="10389" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10303" class="Bound">M</a> <a id="10391" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="10393" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6963" class="Function">subst</a> <a id="10399" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10287" class="Bound">Ï„</a> <a id="10401" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10305" class="Bound">Mâ€²</a>
<a id="10404" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="10414" class="Symbol">{</a><a id="10415" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10415" class="Bound">Î“</a><a id="10416" class="Symbol">}</a> <a id="10418" class="Symbol">{</a><a id="10419" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10419" class="Bound">Î”</a><a id="10420" class="Symbol">}</a> <a id="10422" class="Symbol">{</a><a id="10423" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10423" class="Bound">A</a><a id="10424" class="Symbol">}</a> <a id="10426" class="Symbol">{</a><a id="10427" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10427" class="Bound">Ïƒ</a><a id="10428" class="Symbol">}</a> <a id="10430" class="Symbol">{</a><a id="10431" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10431" class="Bound">Ï„</a><a id="10432" class="Symbol">}</a> <a id="10434" class="Symbol">{</a><a id="10435" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="10437" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10437" class="Bound">x</a><a id="10438" class="Symbol">}</a> <a id="10440" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10440" class="Bound">s</a> <a id="10442" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a> <a id="10447" class="Symbol">=</a> <a id="10449" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10440" class="Bound">s</a>
<a id="10451" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="10461" class="Symbol">{</a><a id="10462" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10462" class="Bound">Î“</a><a id="10463" class="Symbol">}</a> <a id="10465" class="Symbol">{</a><a id="10466" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10466" class="Bound">Î”</a><a id="10467" class="Symbol">}</a> <a id="10469" class="Symbol">{</a><a id="10470" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10470" class="Bound">A</a><a id="10471" class="Symbol">}</a> <a id="10473" class="Symbol">{</a><a id="10474" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10474" class="Bound">Ïƒ</a><a id="10475" class="Symbol">}</a> <a id="10477" class="Symbol">{</a><a id="10478" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10478" class="Bound">Ï„</a><a id="10479" class="Symbol">}</a> <a id="10481" class="Symbol">{</a><a id="10482" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="10484" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10484" class="Bound">N</a><a id="10485" class="Symbol">}</a> <a id="10487" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10487" class="Bound">s</a> <a id="10489" class="Symbol">(</a><a id="10490" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="10495" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10495" class="Bound">p</a><a id="10496" class="Symbol">)</a> <a id="10498" class="Symbol">=</a>
  <a id="10502" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="10507" class="Symbol">(</a><a id="10508" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="10518" class="Symbol">{</a><a id="10519" class="Argument">Ïƒ</a> <a id="10521" class="Symbol">=</a> <a id="10523" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="10528" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10474" class="Bound">Ïƒ</a><a id="10529" class="Symbol">}</a> <a id="10531" class="Symbol">{</a><a id="10532" class="Argument">Ï„</a> <a id="10534" class="Symbol">=</a> <a id="10536" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="10541" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10478" class="Bound">Ï„</a><a id="10542" class="Symbol">}</a>
        <a id="10552" class="Symbol">(Î»</a> <a id="10555" class="Symbol">{</a><a id="10556" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10556" class="Bound">A</a><a id="10557" class="Symbol">}{</a><a id="10559" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10559" class="Bound">x</a><a id="10560" class="Symbol">}</a> <a id="10562" class="Symbol">â†’</a> <a id="10564" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9468" class="Function">par-subst-exts</a> <a id="10579" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10487" class="Bound">s</a> <a id="10581" class="Symbol">{</a><a id="10582" class="Argument">x</a> <a id="10584" class="Symbol">=</a> <a id="10586" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10559" class="Bound">x</a><a id="10587" class="Symbol">})</a> <a id="10590" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10495" class="Bound">p</a><a id="10591" class="Symbol">)</a>
<a id="10593" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="10603" class="Symbol">{</a><a id="10604" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10604" class="Bound">Î“</a><a id="10605" class="Symbol">}</a> <a id="10607" class="Symbol">{</a><a id="10608" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10608" class="Bound">Î”</a><a id="10609" class="Symbol">}</a> <a id="10611" class="Symbol">{</a><a id="10612" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="10613" class="Symbol">}</a> <a id="10615" class="Symbol">{</a><a id="10616" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10616" class="Bound">Ïƒ</a><a id="10617" class="Symbol">}</a> <a id="10619" class="Symbol">{</a><a id="10620" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10620" class="Bound">Ï„</a><a id="10621" class="Symbol">}</a> <a id="10623" class="Symbol">{</a><a id="10624" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10624" class="Bound">L</a> <a id="10626" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="10628" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10628" class="Bound">M</a><a id="10629" class="Symbol">}</a> <a id="10631" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10631" class="Bound">s</a> <a id="10633" class="Symbol">(</a><a id="10634" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="10639" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10639" class="Bound">pâ‚</a> <a id="10642" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10642" class="Bound">pâ‚‚</a><a id="10644" class="Symbol">)</a> <a id="10646" class="Symbol">=</a>
  <a id="10650" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="10655" class="Symbol">(</a><a id="10656" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="10666" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10631" class="Bound">s</a> <a id="10668" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10639" class="Bound">pâ‚</a><a id="10670" class="Symbol">)</a> <a id="10672" class="Symbol">(</a><a id="10673" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="10683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10631" class="Bound">s</a> <a id="10685" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10642" class="Bound">pâ‚‚</a><a id="10687" class="Symbol">)</a>
<a id="10689" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="10699" class="Symbol">{</a><a id="10700" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10700" class="Bound">Î“</a><a id="10701" class="Symbol">}</a> <a id="10703" class="Symbol">{</a><a id="10704" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10704" class="Bound">Î”</a><a id="10705" class="Symbol">}</a> <a id="10707" class="Symbol">{</a><a id="10708" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#2888" class="InductiveConstructor">â˜…</a><a id="10709" class="Symbol">}</a> <a id="10711" class="Symbol">{</a><a id="10712" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10712" class="Bound">Ïƒ</a><a id="10713" class="Symbol">}</a> <a id="10715" class="Symbol">{</a><a id="10716" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10716" class="Bound">Ï„</a><a id="10717" class="Symbol">}</a> <a id="10719" class="Symbol">{(</a><a id="10721" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="10723" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10723" class="Bound">N</a><a id="10724" class="Symbol">)</a> <a id="10726" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="10728" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10728" class="Bound">M</a><a id="10729" class="Symbol">}</a> <a id="10731" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10731" class="Bound">s</a> <a id="10733" class="Symbol">(</a><a id="10734" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2953" class="InductiveConstructor">pbeta</a><a id="10739" class="Symbol">{</a><a id="10740" class="Argument">Nâ€²</a> <a id="10743" class="Symbol">=</a> <a id="10745" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10745" class="Bound">Nâ€²</a><a id="10747" class="Symbol">}{</a><a id="10749" class="Argument">Mâ€²</a> <a id="10752" class="Symbol">=</a> <a id="10754" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10754" class="Bound">Mâ€²</a><a id="10756" class="Symbol">}</a> <a id="10758" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10758" class="Bound">pâ‚</a> <a id="10761" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10761" class="Bound">pâ‚‚</a><a id="10763" class="Symbol">)</a>
    <a id="10769" class="Keyword">with</a> <a id="10774" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2953" class="InductiveConstructor">pbeta</a> <a id="10780" class="Symbol">(</a><a id="10781" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a><a id="10790" class="Symbol">{</a><a id="10791" class="Argument">Ïƒ</a> <a id="10793" class="Symbol">=</a> <a id="10795" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="10800" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10712" class="Bound">Ïƒ</a><a id="10801" class="Symbol">}{</a><a id="10803" class="Argument">Ï„</a> <a id="10805" class="Symbol">=</a> <a id="10807" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#6671" class="Function">exts</a> <a id="10812" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10716" class="Bound">Ï„</a><a id="10813" class="Symbol">}{</a><a id="10815" class="Argument">M</a> <a id="10817" class="Symbol">=</a> <a id="10819" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10723" class="Bound">N</a><a id="10820" class="Symbol">}</a>
                        <a id="10846" class="Symbol">(Î»{</a><a id="10849" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10849" class="Bound">A</a><a id="10850" class="Symbol">}{</a><a id="10852" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10852" class="Bound">x</a><a id="10853" class="Symbol">}</a> <a id="10855" class="Symbol">â†’</a> <a id="10857" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9468" class="Function">par-subst-exts</a> <a id="10872" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10731" class="Bound">s</a> <a id="10874" class="Symbol">{</a><a id="10875" class="Argument">x</a> <a id="10877" class="Symbol">=</a> <a id="10879" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10852" class="Bound">x</a><a id="10880" class="Symbol">})</a> <a id="10883" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10758" class="Bound">pâ‚</a><a id="10885" class="Symbol">)</a>
               <a id="10902" class="Symbol">(</a><a id="10903" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="10913" class="Symbol">{</a><a id="10914" class="Argument">Ïƒ</a> <a id="10916" class="Symbol">=</a> <a id="10918" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10712" class="Bound">Ïƒ</a><a id="10919" class="Symbol">}</a> <a id="10921" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10731" class="Bound">s</a> <a id="10923" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10761" class="Bound">pâ‚‚</a><a id="10925" class="Symbol">)</a>
<a id="10927" class="Symbol">...</a> <a id="10931" class="Symbol">|</a> <a id="10933" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10933" class="Bound">G</a> <a id="10935" class="Keyword">rewrite</a> <a id="10943" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#9994" class="Function">subst-commute</a><a id="10956" class="Symbol">{</a><a id="10957" class="Argument">N</a> <a id="10959" class="Symbol">=</a> <a id="10961" class="Bound">Nâ€²</a><a id="10963" class="Symbol">}{</a><a id="10965" class="Argument">M</a> <a id="10967" class="Symbol">=</a> <a id="10969" class="Bound">Mâ€²</a><a id="10971" class="Symbol">}{</a><a id="10973" class="Argument">Ïƒ</a> <a id="10975" class="Symbol">=</a> <a id="10977" class="Bound">Ï„</a><a id="10978" class="Symbol">}</a> <a id="10980" class="Symbol">=</a> <a id="10982" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10933" class="Bound">G</a>
</pre>{% endraw %}
We proceed by induction on `M â‡› Mâ€²`.

* Suppose `x â‡› x`. We conclude that `Ïƒ x â‡› Ï„ x` using
  the premise `par-subst Ïƒ Ï„`.

* Suppose `Æ› N â‡› Æ› Nâ€²` because `N â‡› Nâ€²`.
  To use the induction hypothesis, we need `par-subst (exts Ïƒ) (exts Ï„)`,
  which we obtain by `par-subst-exts`.
  So we have `subst (exts Ïƒ) N â‡› subst (exts Ï„) Nâ€²`
  and conclude by rule `pabs`.

* Suppose `L Â· M â‡› Lâ€² Â· Mâ€²` because `L â‡› Lâ€²` and `M â‡› Mâ€²`.
  By the induction hypothesis we have
  `subst Ïƒ L â‡› subst Ï„ Lâ€²` and `subst Ïƒ M â‡› subst Ï„ Mâ€²`, so
  we conclude by rule `papp`.

* Suppose `(Æ› N) Â· M  â‡›  Nâ€² [ Mâ€² ]` because `N â‡› Nâ€²` and `M â‡› Mâ€²`.
  Again we obtain `par-subst (exts Ïƒ) (exts Ï„)` by `par-subst-exts`.
  So by the induction hypothesis, we have
  `subst (exts Ïƒ) N â‡› subst (exts Ï„) Nâ€²` and
  `subst Ïƒ M â‡› subst Ï„ Mâ€²`. Then by rule `pbeta`, we have parallel reduction
  to `subst (exts Ï„) Nâ€² [ subst Ï„ Mâ€² ]`.
  Substitution commutes with itself in the following sense.
  For any Ïƒ, N, and M, we have

        (subst (exts Ïƒ) N) [ subst Ïƒ M ] â‰¡ subst Ïƒ (N [ M ])

  So we have parallel reduction to `subst Ï„ (Nâ€² [ Mâ€² ])`.


Of course, if `M â‡› Mâ€²`, then `subst-zero M` pointwise parallel reduces
to `subst-zero Mâ€²`.

{% raw %}<pre class="Agda"><a id="par-subst-zero"></a><a id="12190" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12190" class="Function">par-subst-zero</a> <a id="12205" class="Symbol">:</a> <a id="12207" class="Symbol">âˆ€{</a><a id="12209" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12209" class="Bound">Î“</a><a id="12210" class="Symbol">}{</a><a id="12212" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12212" class="Bound">A</a><a id="12213" class="Symbol">}{</a><a id="12215" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12215" class="Bound">M</a> <a id="12217" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12217" class="Bound">Mâ€²</a> <a id="12220" class="Symbol">:</a> <a id="12222" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12209" class="Bound">Î“</a> <a id="12224" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="12226" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12212" class="Bound">A</a><a id="12227" class="Symbol">}</a>
       <a id="12236" class="Symbol">â†’</a> <a id="12238" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12215" class="Bound">M</a> <a id="12240" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="12242" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12217" class="Bound">Mâ€²</a>
       <a id="12252" class="Symbol">â†’</a> <a id="12254" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#7523" class="Function">par-subst</a> <a id="12264" class="Symbol">(</a><a id="12265" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7375" class="Function">subst-zero</a> <a id="12276" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12215" class="Bound">M</a><a id="12277" class="Symbol">)</a> <a id="12279" class="Symbol">(</a><a id="12280" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7375" class="Function">subst-zero</a> <a id="12291" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12217" class="Bound">Mâ€²</a><a id="12293" class="Symbol">)</a>
<a id="12295" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12190" class="Function">par-subst-zero</a> <a id="12310" class="Symbol">{</a><a id="12311" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12311" class="Bound">M</a><a id="12312" class="Symbol">}</a> <a id="12314" class="Symbol">{</a><a id="12315" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12315" class="Bound">Mâ€²</a><a id="12317" class="Symbol">}</a> <a id="12319" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12319" class="Bound">p</a> <a id="12321" class="Symbol">{</a><a id="12322" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12322" class="Bound">A</a><a id="12323" class="Symbol">}</a> <a id="12325" class="Symbol">{</a><a id="12326" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3557" class="InductiveConstructor">Z</a><a id="12327" class="Symbol">}</a> <a id="12329" class="Symbol">=</a> <a id="12331" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12319" class="Bound">p</a>
<a id="12333" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12190" class="Function">par-subst-zero</a> <a id="12348" class="Symbol">{</a><a id="12349" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12349" class="Bound">M</a><a id="12350" class="Symbol">}</a> <a id="12352" class="Symbol">{</a><a id="12353" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12353" class="Bound">Mâ€²</a><a id="12355" class="Symbol">}</a> <a id="12357" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12357" class="Bound">p</a> <a id="12359" class="Symbol">{</a><a id="12360" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12360" class="Bound">A</a><a id="12361" class="Symbol">}</a> <a id="12363" class="Symbol">{</a><a id="12364" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3602" class="InductiveConstructor Operator">S</a> <a id="12366" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12366" class="Bound">x</a><a id="12367" class="Symbol">}</a> <a id="12369" class="Symbol">=</a> <a id="12371" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a>
</pre>{% endraw %}
We conclude this section with the desired corollary, that substitution
respects parallel reduction.

{% raw %}<pre class="Agda"><a id="sub-par"></a><a id="12486" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12486" class="Function">sub-par</a> <a id="12494" class="Symbol">:</a> <a id="12496" class="Symbol">âˆ€{</a><a id="12498" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12498" class="Bound">Î“</a> <a id="12500" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12500" class="Bound">A</a> <a id="12502" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12502" class="Bound">B</a><a id="12503" class="Symbol">}</a> <a id="12505" class="Symbol">{</a><a id="12506" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12506" class="Bound">N</a> <a id="12508" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12508" class="Bound">Nâ€²</a> <a id="12511" class="Symbol">:</a> <a id="12513" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12498" class="Bound">Î“</a> <a id="12515" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#3191" class="InductiveConstructor Operator">,</a> <a id="12517" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12500" class="Bound">A</a> <a id="12519" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="12521" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12502" class="Bound">B</a><a id="12522" class="Symbol">}</a> <a id="12524" class="Symbol">{</a><a id="12525" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12525" class="Bound">M</a> <a id="12527" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12527" class="Bound">Mâ€²</a> <a id="12530" class="Symbol">:</a> <a id="12532" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12498" class="Bound">Î“</a> <a id="12534" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="12536" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12500" class="Bound">A</a><a id="12537" class="Symbol">}</a>
  <a id="12541" class="Symbol">â†’</a> <a id="12543" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12506" class="Bound">N</a> <a id="12545" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="12547" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12508" class="Bound">Nâ€²</a>
  <a id="12552" class="Symbol">â†’</a> <a id="12554" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12525" class="Bound">M</a> <a id="12556" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="12558" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12527" class="Bound">Mâ€²</a>
    <a id="12565" class="Comment">--------------------------</a>
  <a id="12594" class="Symbol">â†’</a> <a id="12596" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12506" class="Bound">N</a> <a id="12598" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="12600" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12525" class="Bound">M</a> <a id="12602" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">]</a> <a id="12604" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="12606" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12508" class="Bound">Nâ€²</a> <a id="12609" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="12611" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12527" class="Bound">Mâ€²</a> <a id="12614" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">]</a>
<a id="12616" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12486" class="Function">sub-par</a> <a id="12624" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12624" class="Bound">pn</a> <a id="12627" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12627" class="Bound">pm</a> <a id="12630" class="Symbol">=</a> <a id="12632" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#10263" class="Function">subst-par</a> <a id="12642" class="Symbol">(</a><a id="12643" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12190" class="Function">par-subst-zero</a> <a id="12658" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12627" class="Bound">pm</a><a id="12660" class="Symbol">)</a> <a id="12662" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12624" class="Bound">pn</a>
</pre>{% endraw %}
## Parallel reduction satisfies the diamond property

The heart of the confluence proof is made of stone, or rather, of
diamond!  We show that parallel reduction satisfies the diamond
property: that if `M â‡› N` and `M â‡› Nâ€²`, then `N â‡› L` and `Nâ€² â‡› L` for
some `L`.  The typical proof is an induction on `M â‡› N` and `M â‡› Nâ€²`
so that every possible pair gives rise to a witeness `L` given by
performing enough beta reductions in parallel.

However, a simpler approach is to perform as many beta reductions in
parallel as possible on `M`, say `M âº`, and then show that `N` also
parallel reduces to `M âº`. This is the idea of Takahashi's _complete
development_. The desired property may be illustrated as

        M
       /|
      / |
     /  |
    N   2
     \  |
      \ |
       \|
        Mâº

where downward lines are instances of `â‡›`, so we call it the _triangle
property_.

{% raw %}<pre class="Agda"><a id="_âº"></a><a id="13550" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">_âº</a> <a id="13553" class="Symbol">:</a> <a id="13555" class="Symbol">âˆ€</a> <a id="13557" class="Symbol">{</a><a id="13558" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13558" class="Bound">Î“</a> <a id="13560" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13560" class="Bound">A</a><a id="13561" class="Symbol">}</a>
  <a id="13565" class="Symbol">â†’</a> <a id="13567" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13558" class="Bound">Î“</a> <a id="13569" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="13571" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13560" class="Bound">A</a> <a id="13573" class="Symbol">â†’</a> <a id="13575" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13558" class="Bound">Î“</a> <a id="13577" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="13579" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13560" class="Bound">A</a>
<a id="13581" class="Symbol">(</a><a id="13582" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="13584" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13584" class="Bound">x</a><a id="13585" class="Symbol">)</a> <a id="13587" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a>       <a id="13595" class="Symbol">=</a>  <a id="13598" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="13600" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13584" class="Bound">x</a>
<a id="13602" class="Symbol">(</a><a id="13603" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="13605" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13605" class="Bound">M</a><a id="13606" class="Symbol">)</a> <a id="13608" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a>       <a id="13616" class="Symbol">=</a> <a id="13618" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="13620" class="Symbol">(</a><a id="13621" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13605" class="Bound">M</a> <a id="13623" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a><a id="13624" class="Symbol">)</a>
<a id="13626" class="Symbol">((</a><a id="13628" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="13630" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13630" class="Bound">N</a><a id="13631" class="Symbol">)</a> <a id="13633" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="13635" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13635" class="Bound">M</a><a id="13636" class="Symbol">)</a> <a id="13638" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a> <a id="13640" class="Symbol">=</a> <a id="13642" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13630" class="Bound">N</a> <a id="13644" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a> <a id="13646" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">[</a> <a id="13648" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13635" class="Bound">M</a> <a id="13650" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a> <a id="13652" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#7491" class="Function Operator">]</a>
<a id="13654" class="CatchallClause Symbol">(</a><a id="13655" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13655" class="CatchallClause Bound">L</a><a id="13656" class="CatchallClause"> </a><a id="13657" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="CatchallClause InductiveConstructor Operator">Â·</a><a id="13658" class="CatchallClause"> </a><a id="13659" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13659" class="CatchallClause Bound">M</a><a id="13660" class="CatchallClause Symbol">)</a><a id="13661" class="CatchallClause"> </a><a id="13662" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="CatchallClause Function Operator">âº</a>     <a id="13668" class="Symbol">=</a> <a id="13670" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13655" class="Bound">L</a> <a id="13672" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a> <a id="13674" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="13676" class="Symbol">(</a><a id="13677" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13659" class="Bound">M</a> <a id="13679" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a><a id="13680" class="Symbol">)</a>

<a id="par-triangle"></a><a id="13683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13696" class="Symbol">:</a> <a id="13698" class="Symbol">âˆ€</a> <a id="13700" class="Symbol">{</a><a id="13701" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13701" class="Bound">Î“</a> <a id="13703" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13703" class="Bound">A</a><a id="13704" class="Symbol">}</a> <a id="13706" class="Symbol">{</a><a id="13707" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13707" class="Bound">M</a> <a id="13709" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13709" class="Bound">N</a> <a id="13711" class="Symbol">:</a> <a id="13713" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13701" class="Bound">Î“</a> <a id="13715" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="13717" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13703" class="Bound">A</a><a id="13718" class="Symbol">}</a>
  <a id="13722" class="Symbol">â†’</a> <a id="13724" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13707" class="Bound">M</a> <a id="13726" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="13728" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13709" class="Bound">N</a>
    <a id="13734" class="Comment">-------</a>
  <a id="13744" class="Symbol">â†’</a> <a id="13746" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13709" class="Bound">N</a> <a id="13748" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="13750" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13707" class="Bound">M</a> <a id="13752" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a>
<a id="13754" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13767" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a>          <a id="13781" class="Symbol">=</a> <a id="13783" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2703" class="InductiveConstructor">pvar</a>
<a id="13788" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13801" class="Symbol">(</a><a id="13802" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="13807" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13807" class="Bound">p</a><a id="13808" class="Symbol">)</a>      <a id="13815" class="Symbol">=</a> <a id="13817" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="13822" class="Symbol">(</a><a id="13823" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13836" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13807" class="Bound">p</a><a id="13837" class="Symbol">)</a>
<a id="13839" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13852" class="Symbol">(</a><a id="13853" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2953" class="InductiveConstructor">pbeta</a> <a id="13859" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13859" class="Bound">p1</a> <a id="13862" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13862" class="Bound">p2</a><a id="13864" class="Symbol">)</a> <a id="13866" class="Symbol">=</a> <a id="13868" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#12486" class="Function">sub-par</a> <a id="13876" class="Symbol">(</a><a id="13877" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13890" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13859" class="Bound">p1</a><a id="13892" class="Symbol">)</a> <a id="13894" class="Symbol">(</a><a id="13895" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13908" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13862" class="Bound">p2</a><a id="13910" class="Symbol">)</a>
<a id="13912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13925" class="Symbol">(</a><a id="13926" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="13931" class="Symbol">{</a><a id="13932" class="Argument">L</a> <a id="13934" class="Symbol">=</a> <a id="13936" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4382" class="InductiveConstructor Operator">Æ›</a> <a id="13938" class="Symbol">_</a> <a id="13940" class="Symbol">}</a> <a id="13942" class="Symbol">(</a><a id="13943" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2767" class="InductiveConstructor">pabs</a> <a id="13948" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13948" class="Bound">p1</a><a id="13950" class="Symbol">)</a> <a id="13952" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13952" class="Bound">p2</a><a id="13954" class="Symbol">)</a> <a id="13956" class="Symbol">=</a>
  <a id="13960" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2953" class="InductiveConstructor">pbeta</a> <a id="13966" class="Symbol">(</a><a id="13967" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13980" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13948" class="Bound">p1</a><a id="13982" class="Symbol">)</a> <a id="13984" class="Symbol">(</a><a id="13985" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="13998" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13952" class="Bound">p2</a><a id="14000" class="Symbol">)</a>
<a id="14002" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="14015" class="Symbol">(</a><a id="14016" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="14021" class="Symbol">{</a><a id="14022" class="Argument">L</a> <a id="14024" class="Symbol">=</a> <a id="14026" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4330" class="InductiveConstructor Operator">`</a> <a id="14028" class="Symbol">_}</a>   <a id="14033" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#14033" class="Bound">p1</a> <a id="14036" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#14036" class="Bound">p2</a><a id="14038" class="Symbol">)</a> <a id="14040" class="Symbol">=</a> <a id="14042" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="14047" class="Symbol">(</a><a id="14048" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="14061" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#14033" class="Bound">p1</a><a id="14063" class="Symbol">)</a> <a id="14065" class="Symbol">(</a><a id="14066" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="14079" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#14036" class="Bound">p2</a><a id="14081" class="Symbol">)</a>
<a id="14083" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="14096" class="Symbol">(</a><a id="14097" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="14102" class="Symbol">{</a><a id="14103" class="Argument">L</a> <a id="14105" class="Symbol">=</a> <a id="14107" class="Symbol">_</a> <a id="14109" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4442" class="InductiveConstructor Operator">Â·</a> <a id="14111" class="Symbol">_}</a> <a id="14114" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#14114" class="Bound">p1</a> <a id="14117" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#14117" class="Bound">p2</a><a id="14119" class="Symbol">)</a> <a id="14121" class="Symbol">=</a> <a id="14123" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2847" class="InductiveConstructor">papp</a> <a id="14128" class="Symbol">(</a><a id="14129" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="14142" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#14114" class="Bound">p1</a><a id="14144" class="Symbol">)</a> <a id="14146" class="Symbol">(</a><a id="14147" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="14160" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#14117" class="Bound">p2</a><a id="14162" class="Symbol">)</a>
</pre>{% endraw %}
The proof of the triangle property is an induction on `M â‡› N`.

* Suppose `x â‡› x`. Clearly `x âº = x`, so `x â‡› x`.

* Suppose `Æ› M â‡› Æ› N`. By the induction hypothesis we have `N â‡› M âº`
  and by definition `(Î» M) âº = Î» (M âº)`, so we conclude that `Î» N â‡› Î»
  (M âº)`.

* Suppose `(Î» N) Â· M â‡› Nâ€² [ Mâ€² ]`. By the induction hypothesis, we have
  `Nâ€² â‡› N âº` and `Mâ€² â‡› M âº`. Since substitution respects parallel reduction,
  it follows that `Nâ€² [ Mâ€² ] â‡› N âº [ M âº ]`, but the right hand side
  is exactly `((Î» N) Â· M) âº`, hence `Nâ€² [ Mâ€² ] â‡› ((Î» N) Â· M) âº`.

* Suppose `(Î» L) Â· M â‡› (Î» Lâ€²) Â· Mâ€²`. By the induction hypothesis
  we have `Lâ€² â‡› L âº` and `Mâ€² â‡› M âº`; by definition `((Î» L) Â· M) âº = L âº [ M âº ]`.
  It follows `(Î» Lâ€²) Â· Mâ€² â‡› L âº [ M âº ]`.

* Suppose `x Â· M â‡› x Â· Mâ€²`. By the induction hypothesis we have `Mâ€² â‡› M âº`
  and `x â‡› x âº` so that `x Â· Mâ€² â‡› x Â· M âº`.
  The remaining case is proved in the same way, so we ignore it.  (As
  there is currently no way in Agda to expand the catch-all pattern in
  the definition of `_âº` for us before checking the right-hand side,
  we have to write down the remaining case explicitly.)

The diamond property then follows by halving the diamond into two triangles.

        M
       /|\
      / | \
     /  |  \
    N   2   Nâ€²
     \  |  /
      \ | /
       \|/
        Mâº

That is, the diamond property is proved by applying the
triangle property on each side with the same confluent term `M âº`.

{% raw %}<pre class="Agda"><a id="par-diamond"></a><a id="15609" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15609" class="Function">par-diamond</a> <a id="15621" class="Symbol">:</a> <a id="15623" class="Symbol">âˆ€{</a><a id="15625" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15625" class="Bound">Î“</a> <a id="15627" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15627" class="Bound">A</a><a id="15628" class="Symbol">}</a> <a id="15630" class="Symbol">{</a><a id="15631" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15631" class="Bound">M</a> <a id="15633" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15633" class="Bound">N</a> <a id="15635" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15635" class="Bound">Nâ€²</a> <a id="15638" class="Symbol">:</a> <a id="15640" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15625" class="Bound">Î“</a> <a id="15642" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="15644" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15627" class="Bound">A</a><a id="15645" class="Symbol">}</a>
  <a id="15649" class="Symbol">â†’</a> <a id="15651" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15631" class="Bound">M</a> <a id="15653" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="15655" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15633" class="Bound">N</a>
  <a id="15659" class="Symbol">â†’</a> <a id="15661" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15631" class="Bound">M</a> <a id="15663" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="15665" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15635" class="Bound">Nâ€²</a>
    <a id="15672" class="Comment">---------------------------------</a>
  <a id="15708" class="Symbol">â†’</a> <a id="15710" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Î£[</a> <a id="15713" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15713" class="Bound">L</a> <a id="15715" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">âˆˆ</a> <a id="15717" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15625" class="Bound">Î“</a> <a id="15719" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="15721" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15627" class="Bound">A</a> <a id="15723" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">]</a> <a id="15725" class="Symbol">(</a><a id="15726" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15633" class="Bound">N</a> <a id="15728" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="15730" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15713" class="Bound">L</a><a id="15731" class="Symbol">)</a> <a id="15733" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="15735" class="Symbol">(</a><a id="15736" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15635" class="Bound">Nâ€²</a> <a id="15739" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="15741" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15713" class="Bound">L</a><a id="15742" class="Symbol">)</a>
<a id="15744" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15609" class="Function">par-diamond</a> <a id="15756" class="Symbol">{</a><a id="15757" class="Argument">M</a> <a id="15759" class="Symbol">=</a> <a id="15761" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15761" class="Bound">M</a><a id="15762" class="Symbol">}</a> <a id="15764" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15764" class="Bound">p1</a> <a id="15767" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15767" class="Bound">p2</a> <a id="15770" class="Symbol">=</a> <a id="15772" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="15774" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15761" class="Bound">M</a> <a id="15776" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13550" class="Function Operator">âº</a> <a id="15778" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="15780" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="15782" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="15795" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15764" class="Bound">p1</a> <a id="15798" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="15800" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="15813" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#15767" class="Bound">p2</a> <a id="15816" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="15818" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a>
</pre>{% endraw %}
This step is optional, though, in the presence of triangle property.

#### Exercise (practice)

* Prove the diamond property `par-diamond` directly by induction on `M â‡› N` and `M â‡› Nâ€²`.

* Draw pictures that represent the proofs of each of the six cases in
  the direct proof of `par-diamond`. The pictures should consist of nodes
  and directed edges, where each node is labeled with a term and each
  edge represents parallel reduction.

## Proof of confluence for parallel reduction

As promised at the beginning, the proof that parallel reduction is
confluent is easy now that we know it satisfies the triangle property.
We just need to prove the strip lemma, which states that
if `M â‡› N` and `M â‡›* Nâ€²`, then
`N â‡›* L` and `Nâ€² â‡› L` for some `L`.
The following diagram illustrates the strip lemma

        M
       / \
      1   *
     /     \
    N       Nâ€²
     \     /
      *   1
       \ /
        L

where downward lines are instances of `â‡›` or `â‡›*`, depending on how
they are marked.

The proof of the strip lemma is a straightforward induction on `M â‡›* Nâ€²`,
using the triangle property in the induction step.

{% raw %}<pre class="Agda"><a id="strip"></a><a id="16949" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16949" class="Function">strip</a> <a id="16955" class="Symbol">:</a> <a id="16957" class="Symbol">âˆ€{</a><a id="16959" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16959" class="Bound">Î“</a> <a id="16961" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16961" class="Bound">A</a><a id="16962" class="Symbol">}</a> <a id="16964" class="Symbol">{</a><a id="16965" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16965" class="Bound">M</a> <a id="16967" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16967" class="Bound">N</a> <a id="16969" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16969" class="Bound">Nâ€²</a> <a id="16972" class="Symbol">:</a> <a id="16974" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16959" class="Bound">Î“</a> <a id="16976" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="16978" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16961" class="Bound">A</a><a id="16979" class="Symbol">}</a>
  <a id="16983" class="Symbol">â†’</a> <a id="16985" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16965" class="Bound">M</a> <a id="16987" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="16989" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16967" class="Bound">N</a>
  <a id="16993" class="Symbol">â†’</a> <a id="16995" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16965" class="Bound">M</a> <a id="16997" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="17000" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16969" class="Bound">Nâ€²</a>
    <a id="17007" class="Comment">------------------------------------</a>
  <a id="17046" class="Symbol">â†’</a> <a id="17048" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Î£[</a> <a id="17051" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17051" class="Bound">L</a> <a id="17053" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">âˆˆ</a> <a id="17055" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16959" class="Bound">Î“</a> <a id="17057" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="17059" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16961" class="Bound">A</a> <a id="17061" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">]</a> <a id="17063" class="Symbol">(</a><a id="17064" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16967" class="Bound">N</a> <a id="17066" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="17069" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17051" class="Bound">L</a><a id="17070" class="Symbol">)</a>  <a id="17073" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">Ã—</a>  <a id="17076" class="Symbol">(</a><a id="17077" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16969" class="Bound">Nâ€²</a> <a id="17080" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2654" class="Datatype Operator">â‡›</a> <a id="17082" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17051" class="Bound">L</a><a id="17083" class="Symbol">)</a>
<a id="17085" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16949" class="Function">strip</a><a id="17090" class="Symbol">{</a><a id="17091" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17091" class="Bound">Î“</a><a id="17092" class="Symbol">}{</a><a id="17094" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17094" class="Bound">A</a><a id="17095" class="Symbol">}{</a><a id="17097" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17097" class="Bound">M</a><a id="17098" class="Symbol">}{</a><a id="17100" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17100" class="Bound">N</a><a id="17101" class="Symbol">}{</a><a id="17103" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17103" class="Bound">Nâ€²</a><a id="17105" class="Symbol">}</a> <a id="17107" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17107" class="Bound">mn</a> <a id="17110" class="Symbol">(</a><a id="17111" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17097" class="Bound">M</a> <a id="17113" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3807" class="InductiveConstructor Operator">âˆ</a><a id="17114" class="Symbol">)</a> <a id="17116" class="Symbol">=</a> <a id="17118" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17120" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17100" class="Bound">N</a> <a id="17122" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17124" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17126" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17100" class="Bound">N</a> <a id="17128" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3807" class="InductiveConstructor Operator">âˆ</a> <a id="17130" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17132" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17107" class="Bound">mn</a> <a id="17135" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="17137" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a>
<a id="17139" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16949" class="Function">strip</a><a id="17144" class="Symbol">{</a><a id="17145" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17145" class="Bound">Î“</a><a id="17146" class="Symbol">}{</a><a id="17148" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17148" class="Bound">A</a><a id="17149" class="Symbol">}{</a><a id="17151" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17151" class="Bound">M</a><a id="17152" class="Symbol">}{</a><a id="17154" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17154" class="Bound">N</a><a id="17155" class="Symbol">}{</a><a id="17157" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17157" class="Bound">Nâ€²</a><a id="17159" class="Symbol">}</a> <a id="17161" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17161" class="Bound">mn</a> <a id="17164" class="Symbol">(</a><a id="17165" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17151" class="Bound">M</a> <a id="17167" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">â‡›âŸ¨</a> <a id="17170" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17170" class="Bound">mm&#39;</a> <a id="17174" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">âŸ©</a> <a id="17176" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17176" class="Bound">m&#39;n&#39;</a><a id="17180" class="Symbol">)</a>
  <a id="17184" class="Keyword">with</a> <a id="17189" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16949" class="Function">strip</a> <a id="17195" class="Symbol">(</a><a id="17196" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="17209" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17170" class="Bound">mm&#39;</a><a id="17212" class="Symbol">)</a> <a id="17214" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17176" class="Bound">m&#39;n&#39;</a>
<a id="17219" class="Symbol">...</a> <a id="17223" class="Symbol">|</a> <a id="17225" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17227" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17227" class="Bound">L</a> <a id="17229" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17231" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17233" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17233" class="Bound">ll&#39;</a> <a id="17237" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17239" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17239" class="Bound">n&#39;l&#39;</a> <a id="17244" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="17246" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="17248" class="Symbol">=</a> <a id="17250" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17252" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17227" class="Bound">L</a> <a id="17254" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17256" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17258" class="Bound">N</a> <a id="17260" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">â‡›âŸ¨</a> <a id="17263" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#13683" class="Function">par-triangle</a> <a id="17276" class="Bound">mn</a> <a id="17279" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">âŸ©</a> <a id="17281" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17233" class="Bound">ll&#39;</a> <a id="17285" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17287" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17239" class="Bound">n&#39;l&#39;</a> <a id="17292" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="17294" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a>
</pre>{% endraw %}
The proof of confluence for parallel reduction is now proved by
induction on the sequence `M â‡›* N`, using the above lemma in the
induction step.

{% raw %}<pre class="Agda"><a id="par-confluence"></a><a id="17451" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17451" class="Function">par-confluence</a> <a id="17466" class="Symbol">:</a> <a id="17468" class="Symbol">âˆ€{</a><a id="17470" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17470" class="Bound">Î“</a> <a id="17472" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17472" class="Bound">A</a><a id="17473" class="Symbol">}</a> <a id="17475" class="Symbol">{</a><a id="17476" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17476" class="Bound">L</a> <a id="17478" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17478" class="Bound">Mâ‚</a> <a id="17481" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17481" class="Bound">Mâ‚‚</a> <a id="17484" class="Symbol">:</a> <a id="17486" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17470" class="Bound">Î“</a> <a id="17488" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="17490" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17472" class="Bound">A</a><a id="17491" class="Symbol">}</a>
  <a id="17495" class="Symbol">â†’</a> <a id="17497" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17476" class="Bound">L</a> <a id="17499" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="17502" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17478" class="Bound">Mâ‚</a>
  <a id="17507" class="Symbol">â†’</a> <a id="17509" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17476" class="Bound">L</a> <a id="17511" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="17514" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17481" class="Bound">Mâ‚‚</a>
    <a id="17521" class="Comment">------------------------------------</a>
  <a id="17560" class="Symbol">â†’</a> <a id="17562" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Î£[</a> <a id="17565" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17565" class="Bound">N</a> <a id="17567" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">âˆˆ</a> <a id="17569" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17470" class="Bound">Î“</a> <a id="17571" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="17573" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17472" class="Bound">A</a> <a id="17575" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">]</a> <a id="17577" class="Symbol">(</a><a id="17578" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17478" class="Bound">Mâ‚</a> <a id="17581" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="17584" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17565" class="Bound">N</a><a id="17585" class="Symbol">)</a> <a id="17587" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="17589" class="Symbol">(</a><a id="17590" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17481" class="Bound">Mâ‚‚</a> <a id="17593" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3757" class="Datatype Operator">â‡›*</a> <a id="17596" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17565" class="Bound">N</a><a id="17597" class="Symbol">)</a>
<a id="17599" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17451" class="Function">par-confluence</a> <a id="17614" class="Symbol">{</a><a id="17615" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17615" class="Bound">Î“</a><a id="17616" class="Symbol">}{</a><a id="17618" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17618" class="Bound">A</a><a id="17619" class="Symbol">}{</a><a id="17621" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17621" class="Bound">L</a><a id="17622" class="Symbol">}{</a><a id="17624" class="DottedPattern Symbol">.</a><a id="17625" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17621" class="DottedPattern Bound">L</a><a id="17626" class="Symbol">}{</a><a id="17628" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17628" class="Bound">N</a><a id="17629" class="Symbol">}</a> <a id="17631" class="Symbol">(</a><a id="17632" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17621" class="Bound">L</a> <a id="17634" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3807" class="InductiveConstructor Operator">âˆ</a><a id="17635" class="Symbol">)</a> <a id="17637" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17637" class="Bound">Lâ‡›*N</a> <a id="17642" class="Symbol">=</a> <a id="17644" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17646" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17628" class="Bound">N</a> <a id="17648" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17650" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17652" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17637" class="Bound">Lâ‡›*N</a> <a id="17657" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17659" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17628" class="Bound">N</a> <a id="17661" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3807" class="InductiveConstructor Operator">âˆ</a> <a id="17663" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="17665" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a>
<a id="17667" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17451" class="Function">par-confluence</a> <a id="17682" class="Symbol">{</a><a id="17683" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17683" class="Bound">Î“</a><a id="17684" class="Symbol">}{</a><a id="17686" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17686" class="Bound">A</a><a id="17687" class="Symbol">}{</a><a id="17689" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17689" class="Bound">L</a><a id="17690" class="Symbol">}{</a><a id="17692" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17692" class="Bound">Mâ‚â€²</a><a id="17695" class="Symbol">}{</a><a id="17697" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17697" class="Bound">Mâ‚‚</a><a id="17699" class="Symbol">}</a> <a id="17701" class="Symbol">(</a><a id="17702" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17689" class="Bound">L</a> <a id="17704" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">â‡›âŸ¨</a> <a id="17707" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17707" class="Bound">Lâ‡›Mâ‚</a> <a id="17712" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">âŸ©</a> <a id="17714" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17714" class="Bound">Mâ‚â‡›*Mâ‚â€²</a><a id="17721" class="Symbol">)</a> <a id="17723" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17723" class="Bound">Lâ‡›*Mâ‚‚</a>
    <a id="17733" class="Keyword">with</a> <a id="17738" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#16949" class="Function">strip</a> <a id="17744" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17707" class="Bound">Lâ‡›Mâ‚</a> <a id="17749" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17723" class="Bound">Lâ‡›*Mâ‚‚</a>
<a id="17755" class="Symbol">...</a> <a id="17759" class="Symbol">|</a> <a id="17761" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17763" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17763" class="Bound">N</a> <a id="17765" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17767" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17769" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17769" class="Bound">Mâ‚â‡›*N</a> <a id="17775" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17777" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17777" class="Bound">Mâ‚‚â‡›N</a> <a id="17782" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="17784" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a>
      <a id="17792" class="Keyword">with</a> <a id="17797" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17451" class="Function">par-confluence</a> <a id="17812" class="Bound">Mâ‚â‡›*Mâ‚â€²</a> <a id="17820" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17769" class="Bound">Mâ‚â‡›*N</a>
<a id="17826" class="Symbol">...</a>   <a id="17832" class="Symbol">|</a> <a id="17834" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17836" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17836" class="Bound">Nâ€²</a> <a id="17839" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17841" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17843" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17843" class="Bound">Mâ‚â€²â‡›*Nâ€²</a> <a id="17851" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17853" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17853" class="Bound">Nâ‡›*Nâ€²</a> <a id="17859" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="17861" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="17863" class="Symbol">=</a>
        <a id="17873" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17875" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17836" class="Bound">Nâ€²</a> <a id="17878" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17880" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="17882" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17843" class="Bound">Mâ‚â€²â‡›*Nâ€²</a> <a id="17890" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="17892" class="Symbol">(</a><a id="17893" class="Bound">Mâ‚‚</a> <a id="17896" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">â‡›âŸ¨</a> <a id="17899" class="Bound">Mâ‚‚â‡›N</a> <a id="17904" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#3863" class="InductiveConstructor Operator">âŸ©</a> <a id="17906" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17853" class="Bound">Nâ‡›*Nâ€²</a><a id="17911" class="Symbol">)</a> <a id="17913" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="17915" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a>
</pre>{% endraw %}
The step case may be illustrated as follows:

            L
           / \
          1   *
         /     \
        Mâ‚ (a)  Mâ‚‚
       / \     /
      *   *   1
     /     \ /
    Mâ‚â€²(b)  N
     \     /
      *   *
       \ /
        Nâ€²

where downward lines are instances of `â‡›` or `â‡›*`, depending on how
they are marked. Here `(a)` holds by `strip` and `(b)` holds by
induction.


## Proof of confluence for reduction

Confluence of reduction is a corollary of confluence for parallel
reduction. From
`L â€”â†  Mâ‚` and `L â€”â†  Mâ‚‚` we have
`L â‡›* Mâ‚` and `L â‡›* Mâ‚‚` by `betas-pars`.
Then by confluence we obtain some `L` such that
`Mâ‚ â‡›* N` and `Mâ‚‚ â‡›* N`, from which we conclude that
`Mâ‚ â€”â†  N` and `Mâ‚‚ â€”â†  N` by `pars-betas`.

{% raw %}<pre class="Agda"><a id="confluence"></a><a id="18644" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18644" class="Function">confluence</a> <a id="18655" class="Symbol">:</a> <a id="18657" class="Symbol">âˆ€{</a><a id="18659" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18659" class="Bound">Î“</a> <a id="18661" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18661" class="Bound">A</a><a id="18662" class="Symbol">}</a> <a id="18664" class="Symbol">{</a><a id="18665" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18665" class="Bound">L</a> <a id="18667" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18667" class="Bound">Mâ‚</a> <a id="18670" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18670" class="Bound">Mâ‚‚</a> <a id="18673" class="Symbol">:</a> <a id="18675" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18659" class="Bound">Î“</a> <a id="18677" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="18679" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18661" class="Bound">A</a><a id="18680" class="Symbol">}</a>
  <a id="18684" class="Symbol">â†’</a> <a id="18686" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18665" class="Bound">L</a> <a id="18688" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11068" class="Datatype Operator">â€”â† </a> <a id="18691" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18667" class="Bound">Mâ‚</a>
  <a id="18696" class="Symbol">â†’</a> <a id="18698" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18665" class="Bound">L</a> <a id="18700" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11068" class="Datatype Operator">â€”â† </a> <a id="18703" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18670" class="Bound">Mâ‚‚</a>
    <a id="18710" class="Comment">-----------------------------------</a>
  <a id="18748" class="Symbol">â†’</a> <a id="18750" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">Î£[</a> <a id="18753" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18753" class="Bound">N</a> <a id="18755" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">âˆˆ</a> <a id="18757" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18659" class="Bound">Î“</a> <a id="18759" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#4294" class="Datatype Operator">âŠ¢</a> <a id="18761" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18661" class="Bound">A</a> <a id="18763" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#916" class="Function">]</a> <a id="18765" class="Symbol">(</a><a id="18766" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18667" class="Bound">Mâ‚</a> <a id="18769" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11068" class="Datatype Operator">â€”â† </a> <a id="18772" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18753" class="Bound">N</a><a id="18773" class="Symbol">)</a> <a id="18775" href="https://agda.github.io/agda-stdlib/v1.3/Data.Product.html#1167" class="Function Operator">Ã—</a> <a id="18777" class="Symbol">(</a><a id="18778" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18670" class="Bound">Mâ‚‚</a> <a id="18781" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Untyped.md %}{% raw %}#11068" class="Datatype Operator">â€”â† </a> <a id="18784" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18753" class="Bound">N</a><a id="18785" class="Symbol">)</a>
<a id="18787" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18644" class="Function">confluence</a> <a id="18798" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18798" class="Bound">Lâ† Mâ‚</a> <a id="18803" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18803" class="Bound">Lâ† Mâ‚‚</a>
    <a id="18812" class="Keyword">with</a> <a id="18817" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#17451" class="Function">par-confluence</a> <a id="18832" class="Symbol">(</a><a id="18833" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4959" class="Function">betas-pars</a> <a id="18844" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18798" class="Bound">Lâ† Mâ‚</a><a id="18848" class="Symbol">)</a> <a id="18850" class="Symbol">(</a><a id="18851" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#4959" class="Function">betas-pars</a> <a id="18862" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18803" class="Bound">Lâ† Mâ‚‚</a><a id="18866" class="Symbol">)</a>
<a id="18868" class="Symbol">...</a> <a id="18872" class="Symbol">|</a> <a id="18874" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="18876" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18876" class="Bound">N</a> <a id="18878" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="18880" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="18882" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18882" class="Bound">Mâ‚â‡›N</a> <a id="18887" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="18889" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18889" class="Bound">Mâ‚‚â‡›N</a> <a id="18894" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="18896" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="18898" class="Symbol">=</a>
      <a id="18906" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="18908" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18876" class="Bound">N</a> <a id="18910" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="18912" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ¨</a> <a id="18914" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6857" class="Function">pars-betas</a> <a id="18925" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18882" class="Bound">Mâ‚â‡›N</a> <a id="18930" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">,</a> <a id="18932" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#6857" class="Function">pars-betas</a> <a id="18943" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#18889" class="Bound">Mâ‚‚â‡›N</a> <a id="18948" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a> <a id="18950" href="{% endraw %}{{ site.baseurl }}{% link out/plfa/part2/Confluence.md %}{% raw %}#2253" class="InductiveConstructor Operator">âŸ©</a>
</pre>{% endraw %}

## Notes

Broadly speaking, this proof of confluence, based on parallel
reduction, is due to W. Tait and P. Martin-Lof (see Barendredgt 1984,
Section 3.2).  Details of the mechanization come from several sources.
The `subst-par` lemma is the "strong substitutivity" lemma of Shafer,
Tebbi, and Smolka (ITP 2015). The proofs of `par-triangle`, `strip`,
and `par-confluence` are based on the notion of complete development
by Takahashi (1995) and Pfenning's 1992 technical report about the
Church-Rosser theorem. In addition, we consulted Nipkow and
Berghofer's mechanization in Isabelle, which is based on an earlier
article by Nipkow (JAR 1996).

## Unicode

This chapter uses the following unicode:

    â‡›  U+21DB  RIGHTWARDS TRIPLE ARROW (\r== or \Rrightarrow)
    âº  U+207A  SUPERSCRIPT PLUS SIGN   (\^+)
